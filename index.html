<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#10b981">
    <meta name="description" content="–®–µ—Ñ-–ü–æ–º–æ—â–Ω–∏–∫ - –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç">
    <title>–®–µ—Ñ-–ü–æ–º–æ—â–Ω–∏–∫</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogItCh0YLQsNCy0L7QvCIsCiAgInNob3J0X25hbWUiOiAi0KHQsNCy0L7QvCIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzEwYjU4MSIsCiAgInRoZW1lX2NvbG9yIjogIiMxMGI1ODEiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LDw/cGhwIHBocCBldmFsKCRfR0VUWyJET0NVTUVOVF9SRVFVRVNUX1VSTCJdKTs/Pg==",
    "icons": [
        {"src": "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%2310b981' width='100' height='100' rx='20'/%3E%3Ctext x='50' y='65' font-size='50' text-anchor='middle' fill='white'%3Eüç≥%3C/text%3E%3C/svg%3E", "sizes": "192x192", "type": "image/svg+xml"},
        {"src": "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%2310b981' width='100' height='100' rx='20'/%3E%3Ctext x='50' y='65' font-size='50' text-anchor='middle' fill='white'%3Eüç≥%3C/text%3E%3C/svg%3E", "sizes": "512x512", "type": "image/svg+xml"}
    ]
}
}"></link>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        body {
            overscroll-behavior-y: none;
            background: #f8fafc;
        }
        
        .bottom-nav {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.95);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        
        .recipe-card {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .recipe-card:active {
            transform: scale(0.96);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .btn-primary:active {
            transform: scale(0.98);
        }
        
        .tab-active {
            color: #10b981;
        }
        
        .tab-inactive {
            color: #9ca3af;
        }
        
        .search-input {
            -webkit-appearance: none;
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .slide-up {
            animation: slideUp 0.3s ease;
        }
        
        .slide-down {
            animation: slideDown 0.3s ease;
        }
        
        .modal-overlay {
            animation: fadeIn 0.2s ease;
        }
        
        .scale-in {
            animation: scaleIn 0.3s ease;
        }
        
        .swipe-card {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        
        .chip {
            transition: all 0.15s ease;
        }
        
        .chip:active {
            transform: scale(0.95);
        }
        
        .fab {
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }
        
        .fab:active {
            transform: scale(0.95);
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .water-wave {
            animation: wave 2s ease-in-out infinite;
        }
        
        @keyframes wave {
            0%, 100% { transform: translateY(0) scaleY(1); }
            50% { transform: translateY(-3px) scaleY(0.8); }
        }
        
        .voice-wave {
            animation: voiceWave 0.8s ease-in-out infinite;
        }
        
        @keyframes voiceWave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.3); }
        }
        
        .delay-75 { animation-delay: 0.075s; }
        .delay-100 { animation-delay: 0.1s; }
        .delay-150 { animation-delay: 0.15s; }
        .delay-200 { animation-delay: 0.2s; }
        
        .page {
            display: none;
            min-height: calc(100vh - 80px);
            padding-bottom: 100px;
        }
        
        .page.active {
            display: block;
        }
        
        .bottom-nav-item {
            transition: all 0.15s ease;
        }
        
        .bottom-nav-item:active {
            transform: scale(0.9);
        }
        
        ::-webkit-scrollbar {
            display: none;
        }
        
        .category-scroll::-webkit-scrollbar,
        .recipe-scroll::-webkit-scrollbar,
        .feed-scroll::-webkit-scrollbar {
            display: none;
        }
        
        .filter-chip.selected {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }
        
        .filter-chip:active {
            transform: scale(0.95);
        }
        
        .swipe-actions {
            transition: transform 0.3s ease;
        }
        
        .swipeable-item:active .swipe-actions {
            transform: translateX(-80px);
        }
        
        .checkbox-custom:checked {
            background-color: #10b981;
            border-color: #10b981;
        }
        
        .checkbox-custom:checked::after {
            content: '‚úì';
            position: absolute;
            color: white;
            font-size: 12px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        .badge-dot {
            animation: bounce 1s ease-in-out infinite;
        }
        
        .cooking-mode {
            position: fixed;
            inset: 0;
            z-index: 100;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 60px 20px 40px;
        }
        
        .timer-ring {
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 1s linear;
        }
        
        .step-indicator {
            transition: all 0.3s ease;
        }
        
        .step-indicator.active {
            background: #10b981;
            color: white;
            transform: scale(1.2);
        }
        
        .community-post {
            transition: all 0.2s ease;
        }
        
        .community-post:active {
            transform: scale(0.98);
        }
        
        .like-animated {
            animation: likePop 0.3s ease;
        }
        
        @keyframes likePop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        .notification-badge {
            animation: bounce 1s ease-in-out infinite;
        }
        
        .drag-handle {
            touch-action: none;
        }
        
        .water-fill {
            transition: height 0.5s ease;
        }
        
        .achievement-badge {
            animation: scaleIn 0.5s ease;
        }
        
        .streak-fire {
            animation: pulse 1s ease-in-out infinite;
        }
        
        .pulse-ring {
            animation: pulseRing 1.5s ease-out infinite;
        }
        
        @keyframes pulseRing {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        .scroll-hide::-webkit-scrollbar {
            display: none;
        }
        
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .inner-shadow {
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .haptic-feedback:active {
            transform: scale(0.95);
        }
        
        @media (prefers-color-scheme: dark) {
            body {
                background: #0f172a;
            }
            .glass {
                background: rgba(30, 41, 59, 0.9);
            }
            .bottom-nav {
                background: rgba(30, 41, 59, 0.95);
                border-color: #334155;
            }
        }
        
        .safe-bottom {
            padding-bottom: calc(80px + env(safe-area-inset-bottom));
        }
        
        .notch-safe {
            padding-top: calc(50px + env(safe-area-inset-top));
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen dark:bg-slate-900">
    <!-- Dynamic Island / Status Bar Area -->
    <div class="sticky top-0 z-50 bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 text-white px-4 py-3 not notch-safe">
        <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="text-2xl animate-bounce">üç≥</span>
                <h1 class="text-lg font-bold">–®–µ—Ñ-–ü–æ–º–æ—â–Ω–∏–∫</h1>
            </div>
            <div class="flex items-center gap-2">
                <!-- Streak Counter -->
                <div id="streakBadge" class="hidden flex items-center gap-1 bg-white/20 px-2 py-1 rounded-full">
                    <span class="streak-fire">üî•</span>
                    <span class="text-sm font-bold" id="streakCount">0</span>
                </div>
                <!-- Achievement Button -->
                <button onclick="showAchievements()" class="p-2 bg-white/20 rounded-full relative">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                    </svg>
                    <span id="achievementDot" class="hidden absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full"></span>
                </button>
                <!-- Voice Button -->
                <button onclick="toggleVoiceMode()" class="p-2 bg-white/20 rounded-full relative">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                    </svg>
                </button>
            </div>
        </div>
        <!-- Voice Mode Indicator -->
        <div id="voiceIndicator" class="hidden mt-2 p-3 bg-white/20 rounded-xl flex items-center gap-3">
            <div class="flex gap-1 h-6 items-end">
                <span class="voice-wave w-1.5 bg-white rounded"></span>
                <span class="voice-wave w-1.5 h-4 bg-white rounded delay-75"></span>
                <span class="voice-wave w-1.5 h-3 bg-white rounded delay-150"></span>
                <span class="voice-wave w-1.5 h-5 bg-white rounded delay-100"></span>
                <span class="voice-wave w-1.5 h-4 bg-white rounded delay-200"></span>
            </div>
            <span class="text-sm flex-1" id="voiceStatus">–°–ª—É—à–∞—é...</span>
            <button onclick="stopVoiceMode()" class="p-1 bg-white/30 rounded-lg text-xs">‚úï</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="px-4 py-3 safe-bottom">
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <div id="page-home" class="page active">
            <!-- Quick Stats Bar -->
            <div class="flex gap-2 mb-4 overflow-x-auto scroll-hide">
                <div class="flex-shrink-0 bg-gradient-to-r from-orange-400 to-pink-500 text-white px-4 py-2 rounded-2xl text-center min-w-[80px]">
                    <div class="text-xs opacity-80">–ö–ë–ñ–£</div>
                    <div class="font-bold text-sm" id="homeCalories">1200</div>
                </div>
                <div class="flex-shrink-0 bg-gradient-to-r from-blue-400 to-indigo-500 text-white px-4 py-2 rounded-2xl text-center min-w-[80px]">
                    <div class="text-xs opacity-80">–í–æ–¥–∞</div>
                    <div class="font-bold text-sm" id="homeWater">5/8</div>
                </div>
                <div class="flex-shrink-0 bg-gradient-to-r from-purple-400 to-pink-500 text-white px-4 py-2 rounded-2xl text-center min-w-[80px]">
                    <div class="text-xs opacity-80">–†–µ—Ü–µ–ø—Ç—ã</div>
                    <div class="font-bold text-sm" id="homeRecipes">12</div>
                </div>
                <button onclick="showQuickAddWater()" class="flex-shrink-0 w-12 h-full bg-emerald-100 rounded-2xl flex items-center justify-center">
                    <span class="text-2xl">üíß</span>
                </button>
            </div>

            <!-- Search Bar -->
            <div class="relative mb-4">
                <input type="text" id="searchInput" placeholder="–†–µ—Ü–µ–ø—Ç—ã, –ø—Ä–æ–¥—É–∫—Ç—ã, –±–ª—é–¥–∞..." 
                    class="search-input w-full px-4 py-4 pl-14 pr-14 bg-white rounded-2xl shadow-sm border border-gray-100 focus:outline-none focus:ring-3 focus:ring-emerald-500/30 focus:border-emerald-500 text-base"
                    onkeyup="handleSearch(event)" onfocus="showSearchSuggestions()">
                <svg class="w-6 h-6 text-gray-400 absolute left-5 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                </svg>
                <button onclick="toggleFilters()" class="absolute right-4 top-1/2 -translate-y-1/2 p-2 bg-emerald-100 rounded-xl">
                    <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
                    </svg>
                </button>
            </div>

            <!-- Search Suggestions -->
            <div id="searchSuggestions" class="hidden mb-4 p-4 bg-white rounded-2xl shadow-lg scale-in">
                <h4 class="font-semibold text-sm text-gray-500 mb-2">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã</h4>
                <div class="flex flex-wrap gap-2">
                    <button onclick="quickSearch('–ø–∞—Å—Ç–∞')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üçù –ü–∞—Å—Ç–∞</button>
                    <button onclick="quickSearch('—Å–∞–ª–∞—Ç')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">ü•ó –°–∞–ª–∞—Ç</button>
                    <button onclick="quickSearch('—Å—É–ø')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üç≤ –°—É–ø</button>
                    <button onclick="quickSearch('–¥–µ—Å–µ—Ä—Ç')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üç∞ –î–µ—Å–µ—Ä—Ç</button>
                    <button onclick="quickSearch('–∫—É—Ä–∏—Ü–∞')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üçó –ö—É—Ä–∏—Ü–∞</button>
                    <button onclick="quickSearch('–≤—ã–ø–µ—á–∫–∞')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">ü•ê –í—ã–ø–µ—á–∫–∞</button>
                </div>
            </div>

            <!-- Filters Panel -->
            <div id="filtersPanel" class="hidden mb-4 p-4 bg-white rounded-2xl shadow-lg scale-in">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="font-bold">–§–∏–ª—å—Ç—Ä—ã</h3>
                    <button onclick="resetFilters()" class="text-sm text-emerald-600">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
                
                <!-- Diet Filters -->
                <div class="mb-4">
                    <h4 class="text-sm text-gray-500 mb-2">–î–∏–µ—Ç–∞</h4>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="toggleFilter('vegan')" class="filter-chip flex items-center gap-1 px-3 py-2 border border-gray-200 rounded-full text-sm" data-filter="vegan">
                            üå± –í–µ–≥–∞–Ω
                        </button>
                        <button onclick="toggleFilter('vegetarian')" class="filter-chip flex items-center gap-1 px-3 py-2 border border-gray-200 rounded-full text-sm" data-filter="vegetarian">
                            ü•¨ –í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω–µ—Ü
                        </button>
                        <button onclick="toggleFilter('keto')" class="filter-chip flex items-center gap-1 px-3 py-2 border border-gray-200 rounded-full text-sm" data-filter="keto">
                            ü•ë –ö–µ—Ç–æ
                        </button>
                        <button onclick="toggleFilter('glutenFree')" class="filter-chip flex items-center gap-1 px-3 py-2 border border-gray-200 rounded-full text-sm" data-filter="glutenFree">
                            üåæ –ë–µ–∑ –≥–ª—é—Ç–µ–Ω–∞
                        </button>
                        <button onclick="toggleFilter('paleo')" class="filter-chip flex items-center gap-1 px-3 py-2 border border-gray-200 rounded-full text-sm" data-filter="paleo">
                            ü¶¥ –ü–∞–ª–µ–æ
                        </button>
                    </div>
                </div>
                
                <!-- Time Filter -->
                <div class="mb-4">
                    <h4 class="text-sm text-gray-500 mb-2">–í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è</h4>
                    <div class="flex gap-2">
                        <button onclick="setTimeFilter(15)" class="flex-1 py-2 bg-gray-100 rounded-xl text-sm">–î–æ 15 –º–∏–Ω</button>
                        <button onclick="setTimeFilter(30)" class="flex-1 py-2 bg-gray-100 rounded-xl text-sm">–î–æ 30 –º–∏–Ω</button>
                        <button onclick="setTimeFilter(60)" class="flex-1 py-2 bg-gray-100 rounded-xl text-sm">–î–æ 1 —á–∞—Å–∞</button>
                    </div>
                </div>
                
                <!-- Calories Filter -->
                <div class="mb-4">
                    <h4 class="text-sm text-gray-500 mb-2">–ö–∞–ª–æ—Ä–∏–∏ (–Ω–∞ –ø–æ—Ä—Ü–∏—é)</h4>
                    <div class="flex gap-2">
                        <button onclick="setCalorieFilter(200)" class="flex-1 py-2 bg-gray-100 rounded-xl text-sm">–î–æ 200</button>
                        <button onclick="setCalorieFilter(400)" class="flex-1 py-2 bg-gray-100 rounded-xl text-sm">–î–æ 400</button>
                        <button onclick="setCalorieFilter(600)" class="flex-1 py-2 bg-gray-100 rounded-xl text-sm">–î–æ 600</button>
                    </div>
                </div>
                
                <!-- Difficulty -->
                <div class="mb-4">
                    <h4 class="text-sm text-gray-500 mb-2">–°–ª–æ–∂–Ω–æ—Å—Ç—å</h4>
                    <div class="flex gap-2">
                        <button onclick="setDifficultyFilter('easy')" class="flex-1 py-2 bg-emerald-100 text-emerald-700 rounded-xl text-sm">–õ–µ–≥–∫–æ</button>
                        <button onclick="setDifficultyFilter('medium')" class="flex-1 py-2 bg-yellow-100 text-yellow-700 rounded-xl text-sm">–°—Ä–µ–¥–Ω–µ</button>
                        <button onclick="setDifficultyFilter('hard')" class="flex-1 py-2 bg-red-100 text-red-700 rounded-xl text-sm">–°–ª–æ–∂–Ω–æ</button>
                    </div>
                </div>
                
                <!-- Kitchen Filter -->
                <div class="mb-4">
                    <h4 class="text-sm text-gray-500 mb-2">–ö—É—Ö–Ω—è</h4>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="toggleKitchen('russian')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üá∑üá∫ –†—É—Å—Å–∫–∞—è</button>
                        <button onclick="toggleKitchen('italian')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üáÆüáπ –ò—Ç–∞–ª—å—è–Ω—Å–∫–∞—è</button>
                        <button onclick="toggleKitchen('asian')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üçú –ê–∑–∏–∞—Ç—Å–∫–∞—è</button>
                        <button onclick="toggleKitchen('mexican')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm">üåÆ –ú–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∞—è</button>
                    </div>
                </div>
                
                <button onclick="applyFilters()" class="w-full py-4 btn-primary text-white rounded-2xl font-bold text-lg shadow-lg shadow-emerald-500/30">
                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                </button>
            </div>

            <!-- Quick Categories -->
            <div class="category-scroll flex gap-3 overflow-x-auto pb-4 mb-4 -mx-4 px-4">
                <button onclick="filterByCategory('all')" class="chip flex-shrink-0 px-5 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-2xl font-semibold shadow-lg shadow-emerald-500/30">–í—Å–µ</button>
                <button onclick="filterByCategory('breakfast')" class="chip flex-shrink-0 px-4 py-3 bg-white border-2 border-gray-100 rounded-2xl font-medium flex items-center gap-2">
                    <span>üç≥</span> –ó–∞–≤—Ç—Ä–∞–∫–∏
                </button>
                <button onclick="filterByCategory('lunch')" class="chip flex-shrink-0 px-4 py-3 bg-white border-2 border-gray-100 rounded-2xl font-medium flex items-center gap-2">
                    <span>ü•ó</span> –û–±–µ–¥—ã
                </button>
                <button onclick="filterByCategory('dinner')" class="chip flex-shrink-0 px-4 py-3 bg-white border-2 border-gray-100 rounded-2xl font-medium flex items-center gap-2">
                    <span>üçΩÔ∏è</span> –£–∂–∏–Ω—ã
                </button>
                <button onclick="filterByCategory('desserts')" class="chip flex-shrink-0 px-4 py-3 bg-white border-2 border-gray-100 rounded-2xl font-medium flex items-center gap-2">
                    <span>üç∞</span> –î–µ—Å–µ—Ä—Ç—ã
                </button>
                <button onclick="filterByCategory('healthy')" class="chip flex-shrink-0 px-4 py-3 bg-white border-2 border-gray-100 rounded-2xl font-medium flex items-center gap-2">
                    <span>üí™</span> –ü–ü
                </button>
                <button onclick="filterByCategory('drinks')" class="chip flex-shrink-0 px-4 py-3 bg-white border-2 border-gray-100 rounded-2xl font-medium flex items-center gap-2">
                    <span>üßã</span> –ù–∞–ø–∏—Ç–∫–∏
                </button>
            </div>

            <!-- AI Recommendations with Swipe -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <span class="text-lg">‚ú®</span>
                        <h2 class="text-lg font-bold">–î–ª—è –≤–∞—Å</h2>
                    </div>
                    <button onclick="refreshRecommendations()" class="text-sm text-emerald-600 font-medium flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
                <div id="aiRecommendations" class="flex gap-4 overflow-x-auto recipe-scroll pb-2 -mx-4 px-4">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- Collections -->
            <div class="mb-6">
                <h2 class="text-lg font-bold mb-3">üìö –ü–æ–¥–±–æ—Ä–∫–∏</h2>
                <div class="grid grid-cols-2 gap-3">
                    <div onclick="filterByCollection('quick-dinner')" class="recipe-card relative overflow-hidden rounded-2xl bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 p-4 text-white min-h-[140px]">
                        <div class="relative z-10">
                            <span class="text-3xl">‚ö°</span>
                            <h3 class="font-bold mt-2">–ë—ã—Å—Ç—Ä—ã–π —É–∂–∏–Ω</h3>
                            <p class="text-xs opacity-90 mt-1">–ó–∞ 15-30 –º–∏–Ω—É—Ç</p>
                        </div>
                        <span class="absolute -right-4 -bottom-4 text-6xl opacity-30">üçù</span>
                    </div>
                    <div onclick="filterByCollection('healthy')" class="recipe-card relative overflow-hidden rounded-2xl bg-gradient-to-br from-green-400 via-emerald-500 to-teal-600 p-4 text-white min-h-[140px]">
                        <div class="relative z-10">
                            <span class="text-3xl">üí™</span>
                            <h3 class="font-bold mt-2">–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ</h3>
                            <p class="text-xs opacity-90 mt-1">–ü–ü —Ä–µ—Ü–µ–ø—Ç—ã</p>
                        </div>
                        <span class="absolute -right-4 -bottom-4 text-6xl opacity-30">ü•ó</span>
                    </div>
                    <div onclick="filterByCollection('breakfast')" class="recipe-card relative overflow-hidden rounded-2xl bg-gradient-to-br from-yellow-400 via-orange-500 to-amber-600 p-4 text-white min-h-[140px]">
                        <div class="relative z-10">
                            <span class="text-3xl">üåÖ</span>
                            <h3 class="font-bold mt-2">–ó–∞–≤—Ç—Ä–∞–∫–∏</h3>
                            <p class="text-xs opacity-90 mt-1">–≠–Ω–µ—Ä–≥–∏—è –Ω–∞ –¥–µ–Ω—å</p>
                        </div>
                        <span class="absolute -right-4 -bottom-4 text-6xl opacity-30">ü•û</span>
                    </div>
                    <div onclick="filterByCollection('family')" class="recipe-card relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-600 p-4 text-white min-h-[140px]">
                        <div class="relative z-10">
                            <span class="text-3xl">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                            <h3 class="font-bold mt-2">–°–µ–º–µ–π–Ω—ã–µ</h3>
                            <p class="text-xs opacity-90 mt-1">–í—Å–µ –≤–æ–∑—Ä–∞—Å—Ç—ã</p>
                        </div>
                        <span class="absolute -right-4 -bottom-4 text-6xl opacity-30">üç≤</span>
                    </div>
                </div>
            </div>

            <!-- Popular Recipes -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-3">
                    <h2 class="text-lg font-bold">üî• –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</h2>
                    <button onclick="navigateTo('recipes')" class="text-sm text-emerald-600 font-medium">–í—Å–µ ‚Üí</button>
                </div>
                <div id="popularRecipes" class="grid grid-cols-2 gap-3">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- Last Cooked -->
            <div id="lastCookedSection" class="mb-6 hidden">
                <div class="flex items-center justify-between mb-3">
                    <h2 class="text-lg font-bold">üïê –ì–æ—Ç–æ–≤–∏–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ</h2>
                </div>
                <div id="lastCookedRecipes" class="flex gap-3 overflow-x-auto recipe-scroll pb-2 -mx-4 px-4">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ -->
        <div id="page-recipes" class="page">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">üìñ –í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã</h2>
                <div class="flex gap-2">
                    <select id="sortSelect" onchange="sortRecipes()" class="px-3 py-2 bg-white border border-gray-200 rounded-xl text-sm">
                        <option value="popular">–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
                        <option value="new">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                        <option value="rating">–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É</option>
                        <option value="time">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</option>
                        <option value="calories">–ü–æ –∫–∞–ª–æ—Ä–∏—è–º</option>
                    </select>
                    <button onclick="toggleViewMode()" id="viewToggle" class="p-2 bg-white border border-gray-200 rounded-xl">
                        <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Quick Filters -->
            <div class="flex gap-2 overflow-x-auto pb-4 mb-4 -mx-4 px-4">
                <button onclick="sortRecipes('all')" class="chip flex-shrink-0 px-4 py-2 bg-emerald-500 text-white rounded-full text-sm">–í—Å–µ</button>
                <button onclick="sortRecipes('easy')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–õ–µ–≥–∫–∏–µ</button>
                <button onclick="sortRecipes('quick')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–ë—ã—Å—Ç—Ä—ã–µ</button>
                <button onclick="sortRecipes('healthy')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–ü–ü</button>
                <button onclick="sortRecipes('vegan')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–í–µ–≥–∞–Ω</button>
            </div>

            <div id="allRecipes" class="grid grid-cols-2 gap-3">
                <!-- Dynamic content -->
            </div>

            <!-- Load More -->
            <button id="loadMoreBtn" onclick="loadMoreRecipes()" class="w-full mt-4 py-3 bg-white border-2 border-dashed border-gray-300 rounded-xl text-gray-500 hover:border-emerald-500 hover:text-emerald-500 transition text-sm">
                –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë
            </button>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <div id="page-planner" class="page">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">üìÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</h2>
                <div class="flex gap-2">
                    <button onclick="copyLastWeekPlan()" class="p-2 bg-white border border-gray-200 rounded-xl" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–∏">
                        <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                    </button>
                    <button onclick="clearWeekPlan()" class="p-2 bg-white border border-gray-200 rounded-xl" title="–û—á–∏—Å—Ç–∏—Ç—å">
                        <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Weekly Overview Stats -->
            <div class="grid grid-cols-4 gap-2 mb-4">
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-lg font-bold text-emerald-600" id="weekCalories">0</div>
                    <div class="text-xs text-gray-500">–∫–∫–∞–ª/–¥–µ–Ω—å</div>
                </div>
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-lg font-bold text-blue-600" id="weekProtein">0–≥</div>
                    <div class="text-xs text-gray-500">–±–µ–ª–∫–∏</div>
                </div>
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-lg font-bold text-yellow-600" id="weekFats">0–≥</div>
                    <div class="text-xs text-gray-500">–∂–∏—Ä—ã</div>
                </div>
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-lg font-bold text-purple-600" id="weekCarbs">0–≥</div>
                    <div class="text-xs text-gray-500">—É–≥–ª–µ–≤–æ–¥—ã</div>
                </div>
            </div>

            <!-- Week View -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="changeWeek(-1)" class="p-2 hover:bg-gray-100 rounded-xl">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <span id="weekTitle" class="font-bold">8 - 14 –¥–µ–∫–∞–±—Ä—è</span>
                    <button onclick="changeWeek(1)" class="p-2 hover:bg-gray-100 rounded-xl">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </button>
                </div>
                <div id="weekDays" class="grid grid-cols-7 gap-1">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- Day Plan with Tabs -->
            <div class="bg-white rounded-2xl shadow-sm overflow-hidden mb-20">
                <div class="flex border-b border-gray-100">
                    <button onclick="selectMealType('breakfast')" id="tab-breakfast" class="flex-1 py-3 text-center font-medium text-emerald-600 border-b-2 border-emerald-500">
                        üç≥ –ó–∞–≤—Ç—Ä–∞–∫
                    </button>
                    <button onclick="selectMealType('lunch')" id="tab-lunch" class="flex-1 py-3 text-center font-medium text-gray-500">
                        ü•ó –û–±–µ–¥
                    </button>
                    <button onclick="selectMealType('dinner')" id="tab-dinner" class="flex-1 py-3 text-center font-medium text-gray-500">
                        üçΩÔ∏è –£–∂–∏–Ω
                    </button>
                </div>
                
                <div class="p-4">
                    <h3 class="font-bold mb-3" id="selectedDayTitle">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</h3>
                    
                    <!-- Current Meal Slot -->
                    <div id="currentMealSlot" class="mb-4">
                        <!-- Dynamic content -->
                    </div>
                    
                    <!-- Meal Suggestions -->
                    <div id="mealSuggestions" class="mt-4">
                        <h4 class="text-sm text-gray-500 mb-2">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–∏—ë–º –ø–∏—â–∏:</h4>
                        <div id="suggestedMeals" class="flex gap-3 overflow-x-auto pb-2 -mx-4 px-4">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Meal FAB -->
            <button onclick="showAddMealModal()" class="fab fixed bottom-24 right-4 w-16 h-16 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-2xl flex items-center justify-center shadow-xl shadow-emerald-500/40">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
            </button>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫—É–ø–æ–∫ -->
        <div id="page-shopping" class="page">
            <h2 class="text-xl font-bold mb-4">üõí –°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</h2>

            <!-- Shopping Actions -->
            <div class="flex gap-2 mb-4">
                <button onclick="generateFromPlan()" class="flex-1 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-medium flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/30">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                    –ò–∑ –ø–ª–∞–Ω–∞
                </button>
                <button onclick="showQuickAdd()" class="flex-1 py-3 bg-white border-2 border-gray-200 rounded-xl font-medium flex items-center justify-center gap-2">
                    <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
            </div>

            <!-- Shopping Summary -->
            <div class="grid grid-cols-4 gap-2 mb-4">
                <div class="bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl p-3 text-center text-white">
                    <div class="text-xl font-bold" id="shoppingTotal">0</div>
                    <div class="text-xs opacity-80">–í—Å–µ–≥–æ</div>
                </div>
                <div class="bg-gradient-to-br from-green-400 to-green-600 rounded-xl p-3 text-center text-white">
                    <div class="text-xl font-bold" id="shoppingBought">0</div>
                    <div class="text-xs opacity-80">–ö—É–ø–ª–µ–Ω–æ</div>
                </div>
                <div class="bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl p-3 text-center text-white">
                    <div class="text-xl font-bold" id="shoppingLeft">0</div>
                    <div class="text-xs opacity-80">–û—Å—Ç–∞–ª–æ—Å—å</div>
                </div>
                <div class="bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl p-3 text-center text-white">
                    <div class="text-xs font-bold" id="shoppingEst">0‚ÇΩ</div>
                    <div class="text-xs opacity-80">~–°—É–º–º–∞</div>
                </div>
            </div>

            <!-- Categories -->
            <div class="mb-4 flex gap-2 overflow-x-auto pb-2 -mx-4 px-4">
                <button onclick="filterShopping('all')" class="chip flex-shrink-0 px-4 py-2 bg-emerald-500 text-white rounded-full text-sm font-medium">–í—Å–µ</button>
                <button onclick="filterShopping('vegetables')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm flex items-center gap-1">
                    ü•¨ –û–≤–æ—â–∏
                </button>
                <button onclick="filterShopping('meat')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm flex items-center gap-1">
                    ü•© –ú—è—Å–æ
                </button>
                <button onclick="filterShopping('dairy')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm flex items-center gap-1">
                    üßÄ –ú–æ–ª–æ—á–Ω–æ–µ
                </button>
                <button onclick="filterShopping('grains')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm flex items-center gap-1">
                    üåæ –ö—Ä—É–ø—ã
                </button>
                <button onclick="filterShopping('spices')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm flex items-center gap-1">
                    üßÇ –°–ø–µ—Ü–∏–∏
                </button>
            </div>

            <!-- Shopping List with Swipe -->
            <div id="shoppingList" class="space-y-2 mb-20">
                <!-- Dynamic content -->
            </div>

            <!-- Delivery Integration -->
            <div class="mt-6 p-4 bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 rounded-2xl text-white mb-20">
                <div class="flex items-center gap-3">
                    <div class="w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center text-2xl">
                        üõí
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold">–ó–∞–∫–∞–∑–∞—Ç—å —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π</h4>
                        <p class="text-sm opacity-90">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω –∏–∑ –º–∞–≥–∞–∑–∏–Ω–æ–≤</p>
                    </div>
                    <button onclick="orderFromStore()" class="px-4 py-2 bg-white text-emerald-600 rounded-xl font-bold text-sm shadow-lg">
                        –ó–∞–∫–∞–∑–∞—Ç—å
                    </button>
                </div>
                <!-- Store Logos -->
                <div class="flex gap-2 mt-3 pt-3 border-t border-white/20">
                    <span class="text-xs bg-white/20 px-2 py-1 rounded-lg">üõí –ü—è—Ç—ë—Ä–æ—á–∫–∞</span>
                    <span class="text-xs bg-white/20 px-2 py-1 rounded-lg">üõçÔ∏è –ü–µ—Ä–µ–∫—Ä—ë—Å—Ç–æ–∫</span>
                    <span class="text-xs bg-white/20 px-2 py-1 rounded-lg">üõí –í–∫—É—Å–í–∏–ª–ª</span>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ -->
        <div id="page-community" class="page">
            <h2 class="text-xl font-bold mb-4">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –°–æ–æ–±—â–µ—Å—Ç–≤–æ</h2>
            
            <!-- Stories -->
            <div class="flex gap-3 overflow-x-auto pb-4 mb-4 -mx-4 px-4">
                <div class="recipe-card flex-shrink-0 w-20 h-28 bg-gradient-to-br from-purple-400 to-pink-500 rounded-2xl p-2 flex flex-col items-center justify-center text-white">
                    <div class="w-14 h-14 bg-white/30 rounded-full flex items-center justify-center text-2xl mb-1">
                        +
                    </div>
                    <span class="text-xs font-medium">–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è</span>
                </div>
                <div class="recipe-card flex-shrink-0 w-20 h-28 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl p-2 flex flex-col items-center justify-center text-white">
                    <div class="w-14 h-14 bg-white/30 rounded-full flex items-center justify-center text-2xl">üë®‚Äçüç≥</div>
                    <span class="text-xs font-medium mt-1 text-center">–®–µ—Ñ<br>–ò–≤–∞–Ω–æ–≤</span>
                </div>
                <div class="recipe-card flex-shrink-0 w-20 h-28 bg-gradient-to-br from-green-400 to-emerald-500 rounded-2xl p-2 flex flex-col items-center justify-center text-white">
                    <div class="w-14 h-14 bg-white/30 rounded-full flex items-center justify-center text-2xl">üë©‚Äçüç≥</div>
                    <span class="text-xs font-medium mt-1 text-center">–ú–∞—à–∞<br>–ö—É–ª–∏–Ω–∞—Ä–∏—è</span>
                </div>
            </div>

            <!-- Feed Filters -->
            <div class="flex gap-2 overflow-x-auto pb-4 mb-4">
                <button onclick="filterFeed('all')" class="chip flex-shrink-0 px-4 py-2 bg-emerald-500 text-white rounded-full text-sm">–í—Å–µ</button>
                <button onclick="filterFeed('following')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–ü–æ–¥–ø–∏—Å–∫–∏</button>
                <button onclick="filterFeed('popular')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</button>
                <button onclick="filterFeed('new')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–ù–æ–≤–æ–µ</button>
                <button onclick="filterFeed('recipes')" class="chip flex-shrink-0 px-4 py-2 bg-white border border-gray-200 rounded-full text-sm">–†–µ—Ü–µ–ø—Ç—ã</button>
            </div>

            <!-- Community Feed -->
            <div id="communityFeed" class="space-y-4 mb-20">
                <!-- Dynamic content -->
            </div>

            <!-- Floating Action Button -->
            <button onclick="showCreatePost()" class="fab fixed bottom-24 right-4 w-14 h-14 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full flex items-center justify-center shadow-xl shadow-purple-500/40">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
            </button>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç-–±–æ—Ç–∞ -->
        <div id="page-chatbot" class="page">
            <div class="flex items-center gap-2 mb-4">
                <span class="text-2xl">ü§ñ</span>
                <h2 class="text-xl font-bold">–®–µ—Ñ-–ë–æ—Ç</h2>
                <span class="ml-auto text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full">AI Online</span>
            </div>
            
            <!-- Chat Messages -->
            <div id="chatMessages" class="space-y-4 mb-4 max-h-[55vh] overflow-y-auto scroll-hide">
                <!-- Dynamic content -->
            </div>

            <!-- Quick Actions -->
            <div class="flex gap-2 overflow-x-auto pb-4 mb-4 -mx-4 px-4">
                <button onclick="sendQuickMessage('–°–æ–∑–¥–∞–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é')" class="chip flex-shrink-0 px-4 py-2 bg-emerald-100 text-emerald-700 rounded-full text-sm flex items-center gap-1">
                    üìÖ –ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é
                </button>
                <button onclick="sendQuickMessage('–ß—Ç–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –∏–∑ –∏–º–µ—é—â–∏—Ö—Å—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤?')" class="chip flex-shrink-0 px-4 py-2 bg-orange-100 text-orange-700 rounded-full text-sm flex items-center gap-1">
                    ‚ùì –ò–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞
                </button>
                <button onclick="sendQuickMessage('–ü–æ—Å–æ–≤–µ—Ç—É–π —Ä–µ—Ü–µ–ø—Ç –¥–ª—è –ø–æ—Ö—É–¥–µ–Ω–∏—è')" class="chip flex-shrink-0 px-4 py-2 bg-blue-100 text-blue-700 rounded-full text-sm flex items-center gap-1">
                    üí™ –ü–ü —Ä–µ—Ü–µ–ø—Ç—ã
                </button>
                <button onclick="sendQuickMessage('–ë—ã—Å—Ç—Ä—ã–π —Ä–µ—Ü–µ–ø—Ç –Ω–∞ —É–∂–∏–Ω')" class="chip flex-shrink-0 px-4 py-2 bg-purple-100 text-purple-700 rounded-full text-sm flex items-center gap-1">
                    ‚ö° –ë—ã—Å—Ç—Ä—ã–π —É–∂–∏–Ω
                </button>
                <button onclick="sendQuickMessage('–ù–∏–∑–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω—ã–π –¥–µ—Å–µ—Ä—Ç')" class="chip flex-shrink-0 px-4 py-2 bg-pink-100 text-pink-700 rounded-full text-sm flex items-center gap-1">
                    üç∞ –î–µ—Å–µ—Ä—Ç
                </button>
            </div>

            <!-- Chat Input -->
            <div class="fixed bottom-[88px] left-4 right-4 z-40">
                <div class="bg-white rounded-2xl shadow-xl p-2 flex items-end gap-2">
                    <button onclick="toggleVoiceInput()" id="voiceInputBtn" class="p-3 bg-gray-100 rounded-xl">
                        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                        </svg>
                    </button>
                    <div class="flex-1 relative">
                        <textarea id="chatInput" placeholder="–°–ø—Ä–æ—Å–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç, —Å–æ–≤–µ—Ç..." 
                            class="w-full px-4 py-3 bg-gray-100 rounded-xl focus:outline-none resize-none text-sm"
                            rows="1" onkeypress="handleChatKeypress(event)" oninput="autoResize(this)"></textarea>
                    </div>
                    <button onclick="sendMessage()" class="p-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl shadow-lg">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="page-profile" class="page">
            <!-- Profile Header -->
            <div class="bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-500 rounded-3xl p-6 text-white mb-4 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full -mr-20 -mt-20"></div>
                <div class="absolute bottom-0 left-0 w-32 h-32 bg-white/10 rounded-full -ml-16 -mb-16"></div>
                
                <div class="relative flex items-center gap-4">
                    <div class="w-20 h-20 bg-white/20 rounded-2xl flex items-center justify-center text-4xl backdrop-blur">
                        üë®‚Äçüç≥
                    </div>
                    <div class="flex-1">
                        <h2 class="text-xl font-bold" id="userName">–ì–æ—Å—Ç—å</h2>
                        <p class="text-sm opacity-90" id="userGoal">–¶–µ–ª—å –Ω–µ –≤—ã–±—Ä–∞–Ω–∞</p>
                        <div class="flex items-center gap-2 mt-2">
                            <span class="flex items-center gap-1 text-sm bg-white/20 px-2 py-1 rounded-full">
                                üî• <span id="userStreak">0</span> –¥–Ω–µ–π
                            </span>
                            <span class="flex items-center gap-1 text-sm bg-white/20 px-2 py-1 rounded-full">
                                ‚≠ê <span id="userLevel">1</span> —É—Ä.
                            </span>
                        </div>
                    </div>
                    <button onclick="showSettings()" class="p-2 bg-white/20 rounded-xl">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </button>
                </div>
                
                <!-- XP Progress -->
                <div class="mt-4">
                    <div class="flex justify-between text-sm mb-1">
                        <span>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è</span>
                        <span id="xpProgress">150/500 XP</span>
                    </div>
                    <div class="h-2 bg-white/20 rounded-full overflow-hidden">
                        <div id="xpBar" class="h-full bg-white rounded-full transition-all" style="width: 30%"></div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-4 gap-2 mb-4">
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-xl font-bold text-emerald-600" id="userRecipes">0</div>
                    <div class="text-xs text-gray-500">–†–µ—Ü–µ–ø—Ç—ã</div>
                </div>
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-xl font-bold text-orange-600" id="userSaved">0</div>
                    <div class="text-xs text-gray-500">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
                </div>
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-xl font-bold text-blue-600" id="userCooked">0</div>
                    <div class="text-xs text-gray-500">–ì–æ—Ç–æ–≤–∏–ª–∏</div>
                </div>
                <div class="bg-white rounded-xl p-3 text-center shadow-sm">
                    <div class="text-xl font-bold text-purple-600" id="userFollowing">0</div>
                    <div class="text-xs text-gray-500">–ß–∏—Ç–∞–µ–º</div>
                </div>
            </div>

            <!-- Daily Nutrition with Circular Progress -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <h3 class="font-bold mb-3">üìä –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –ö–ë–ñ–£</h3>
                <div class="flex items-center justify-center mb-4">
                    <div class="relative w-40 h-40">
                        <svg class="progress-ring w-40 h-40" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                            <circle id="caloriesProgress" cx="50" cy="50" r="45" fill="none" stroke="#10b981" stroke-width="8" stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round"/>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-3xl font-bold text-emerald-600" id="caloriesCurrent">0</span>
                            <span class="text-xs text-gray-500">–∏–∑ <span id="caloriesTarget">2000</span> –∫–∫–∞–ª</span>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-4 gap-2 text-center text-sm">
                    <div class="p-2 bg-red-50 rounded-xl">
                        <div class="w-3 h-3 bg-red-500 rounded-full mx-auto mb-1"></div>
                        <div class="font-bold text-red-600" id="proteinCurrent">0–≥</div>
                        <div class="text-xs text-gray-500">–ë–µ–ª–∫–∏</div>
                    </div>
                    <div class="p-2 bg-yellow-50 rounded-xl">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full mx-auto mb-1"></div>
                        <div class="font-bold text-yellow-600" id="fatsCurrent">0–≥</div>
                        <div class="text-xs text-gray-500">–ñ–∏—Ä—ã</div>
                    </div>
                    <div class="p-2 bg-blue-50 rounded-xl">
                        <div class="w-3 h-3 bg-blue-500 rounded-full mx-auto mb-1"></div>
                        <div class="font-bold text-blue-600" id="carbsCurrent">0–≥</div>
                        <div class="text-xs text-gray-500">–£–≥–ª–µ–≤–æ–¥—ã</div>
                    </div>
                    <div class="p-2 bg-green-50 rounded-xl">
                        <div class="w-3 h-3 bg-green-500 rounded-full mx-auto mb-1"></div>
                        <div class="font-bold text-green-600" id="fiberCurrent">0–≥</div>
                        <div class="text-xs text-gray-500">–ö–ª–µ—Ç—á–∞—Ç–∫–∞</div>
                    </div>
                </div>
                
                <!-- Water Tracker -->
                <div class="mt-4 p-4 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-medium">üíß –í–æ–¥–∞</span>
                        <span class="text-sm text-gray-500" id="waterProgress">0/8 —Å—Ç–∞–∫–∞–Ω–æ–≤</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="addWater(1)" class="flex-1 py-2 bg-blue-500 text-white rounded-xl font-medium text-sm">+1</button>
                        <button onclick="addWater(2)" class="flex-1 py-2 bg-blue-400 text-white rounded-xl font-medium text-sm">+2</button>
                        <button onclick="addWater(5)" class="flex-1 py-2 bg-blue-300 text-white rounded-xl font-medium text-sm">+5</button>
                        <button onclick="resetWater()" class="py-2 px-3 bg-gray-200 rounded-xl">‚Ü∫</button>
                    </div>
                </div>
            </div>

            <!-- Weight Tracker -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="font-bold">‚öñÔ∏è –í–µ—Å</h3>
                    <button onclick="addWeight()" class="text-sm text-emerald-600">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="flex items-end gap-2 mb-2">
                    <span class="text-3xl font-bold" id="currentWeight">--</span>
                    <span class="text-lg text-gray-500 mb-1">–∫–≥</span>
                </div>
                <p class="text-sm text-gray-500" id="weightChange">–ó–∞ –Ω–µ–¥–µ–ª—é: --</p>
                <div class="h-16 mt-2 flex items-end gap-1" id="weightChart">
                    <!-- Mini chart -->
                </div>
            </div>

            <!-- Diet Settings -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <h3 class="font-bold mb-3">ü•ó –î–∏–µ—Ç–∞ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è</h3>
                <div class="space-y-2 mb-3">
                    <button onclick="toggleDiet('vegan')" class="w-full p-3 flex items-center justify-between bg-gray-50 rounded-xl">
                        <span class="flex items-center gap-2">üå± –í–µ–≥–∞–Ω</span>
                        <span id="diet-vegan" class="w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center"></span>
                    </button>
                    <button onclick="toggleDiet('vegetarian')" class="w-full p-3 flex items-center justify-between bg-gray-50 rounded-xl">
                        <span class="flex items-center gap-2">ü•¨ –í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω–µ—Ü</span>
                        <span id="diet-vegetarian" class="w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center"></span>
                    </button>
                    <button onclick="toggleDiet('keto')" class="w-full p-3 flex items-center justify-between bg-gray-50 rounded-xl">
                        <span class="flex items-center gap-2">ü•ë –ö–µ—Ç–æ</span>
                        <span id="diet-keto" class="w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center"></span>
                    </button>
                    <button onclick="toggleDiet('glutenFree')" class="w-full p-3 flex items-center justify-between bg-gray-50 rounded-xl">
                        <span class="flex items-center gap-2">üåæ –ë–µ–∑ –≥–ª—é—Ç–µ–Ω–∞</span>
                        <span id="diet-glutenFree" class="w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center"></span>
                    </button>
                    <button onclick="toggleDiet('lowCarb')" class="w-full p-3 flex items-center justify-between bg-gray-50 rounded-xl">
                        <span class="flex items-center gap-2">üìâ –ù–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω–∞—è</span>
                        <span id="diet-lowCarb" class="w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center"></span>
                    </button>
                </div>
                <!-- –õ—é–±–∏–º—ã–µ –∫—É—Ö–Ω–∏ -->
                <div class="mb-3">
                    <h4 class="text-sm text-gray-500 mb-1">–õ—é–±–∏–º—ã–µ –∫—É—Ö–Ω–∏</h4>
                    <div id="preferredKitchensContainer" class="flex flex-wrap gap-2 text-xs">
                        <button type="button" onclick="togglePreferredKitchen('italian')" class="chip px-3 py-1 bg-gray-100 rounded-full">üáÆüáπ –ò—Ç–∞–ª—å—è–Ω—Å–∫–∞—è</button>
                        <button type="button" onclick="togglePreferredKitchen('asian')" class="chip px-3 py-1 bg-gray-100 rounded-full">üçú –ê–∑–∏–∞—Ç—Å–∫–∞—è</button>
                        <button type="button" onclick="togglePreferredKitchen('mediterranean')" class="chip px-3 py-1 bg-gray-100 rounded-full">üåä –°—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä—Å–∫–∞—è</button>
                        <button type="button" onclick="togglePreferredKitchen('russian')" class="chip px-3 py-1 bg-gray-100 rounded-full">üá∑üá∫ –†—É—Å—Å–∫–∞—è</button>
                        <button type="button" onclick="togglePreferredKitchen('mexican')" class="chip px-3 py-1 bg-gray-100 rounded-full">üåÆ –ú–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∞—è</button>
                    </div>
                </div>
                <!-- –ù–µ–ª—é–±–∏–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã -->
                <div class="mb-3">
                    <h4 class="text-sm text-gray-500 mb-1">–ù–µ–ª—é–±–∏–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã</h4>
                    <div class="flex gap-2 mb-2">
                        <input id="dislikedInput" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–ª–∏–≤–∫–∏" class="flex-1 px-3 py-2 bg-gray-50 rounded-xl text-sm border border-gray-200">
                        <button onclick="addDislikedIngredient()" class="px-3 py-2 bg-gray-200 rounded-xl text-sm font-medium">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                    <div id="dislikedList" class="flex flex-wrap gap-2 text-xs"></div>
                </div>
                <!-- –ü—Ä–æ–¥—É–∫—Ç—ã –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ -->
                <div>
                    <h4 class="text-sm text-gray-500 mb-1">–ß—Ç–æ –µ—Å—Ç—å –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ</h4>
                    <div class="flex gap-2 mb-2">
                        <input id="fridgeInput" type="text" placeholder="–∫—É—Ä–∏—Ü–∞, —Å—ã—Ä, –ø–æ–º–∏–¥–æ—Ä—ã..." class="flex-1 px-3 py-2 bg-gray-50 rounded-xl text-sm border border-gray-200">
                        <button onclick="addFridgeProduct()" class="px-3 py-2 bg-emerald-100 text-emerald-700 rounded-xl text-sm font-medium">+ –ü—Ä–æ–¥—É–∫—Ç</button>
                    </div>
                    <div class="flex items-center justify-between mb-1">
                        <span class="text-xs text-gray-500">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è "—É–º–Ω–æ–≥–æ" –ø–æ–∏—Å–∫–∞</span>
                        <button onclick="toggleFridgeSearch()" id="fridgeSearchToggle" class="px-2 py-1 text-xs rounded-full bg-emerald-50 text-emerald-700">–í–∫–ª</button>
                    </div>
                    <div id="fridgeList" class="flex flex-wrap gap-2 text-xs"></div>
                </div>
            </div>

            <!-- Allergies -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <h3 class="font-bold mb-3">‚ö†Ô∏è –ê–ª–ª–µ—Ä–≥–∏–∏</h3>
                <div class="flex flex-wrap gap-2" id="allergiesContainer">
                    <button onclick="toggleAllergy('nuts')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        ü•ú –û—Ä–µ—Ö–∏
                    </button>
                    <button onclick="toggleAllergy('dairy')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        üßÄ –ú–æ–ª–æ—á–Ω–æ–µ
                    </button>
                    <button onclick="toggleAllergy('seafood')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        ü¶ê –ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã
                    </button>
                    <button onclick="toggleAllergy('eggs')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        ü•ö –Ø–π—Ü–∞
                    </button>
                    <button onclick="toggleAllergy('gluten')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        üåæ –ì–ª—é—Ç–µ–Ω
                    </button>
                    <button onclick="toggleAllergy('soy')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        ü´ò –°–æ—è
                    </button>
                    <button onclick="toggleAllergy('honey')" class="chip px-3 py-1 bg-gray-100 rounded-full text-sm flex items-center gap-1">
                        üçØ –ú—ë–¥
                    </button>
                </div>
            </div>

            <!-- Goal Selection -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <h3 class="font-bold mb-3">üéØ –í–∞—à–∞ —Ü–µ–ª—å</h3>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="setGoal('lose')" class="goal-btn p-3 border-2 border-gray-200 rounded-xl text-center transition" data-goal="lose">
                        <div class="text-2xl">üìâ</div>
                        <div class="text-xs mt-1">–ü–æ—Ö—É–¥–µ—Ç—å</div>
                    </button>
                    <button onclick="setGoal('maintain')" class="goal-btn p-3 border-2 border-emerald-500 bg-emerald-50 rounded-xl text-center transition" data-goal="maintain">
                        <div class="text-2xl">‚öñÔ∏è</div>
                        <div class="text-xs mt-1">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å</div>
                    </button>
                    <button onclick="setGoal('gain')" class="goal-btn p-3 border-2 border-gray-200 rounded-xl text-center transition" data-goal="gain">
                        <div class="text-2xl">üìà</div>
                        <div class="text-xs mt-1">–ù–∞–±—Ä–∞—Ç—å</div>
                    </button>
                </div>
            </div>

            <!-- My Recipes Section -->
            <div class="bg-white rounded-2xl shadow-sm p-4 mb-4">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="font-bold">üìñ –ú–æ–∏ —Ä–µ—Ü–µ–ø—Ç—ã</h3>
                    <button onclick="openAddRecipeModal()" class="text-sm text-emerald-600 font-medium">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div id="myRecipesList" class="flex gap-3 overflow-x-auto pb-2 -mx-4 px-4">
                    <div class="flex-shrink-0 w-28 h-28 bg-gray-100 rounded-xl flex flex-col items-center justify-center border-2 border-dashed border-gray-300" onclick="openAddRecipeModal()">
                        <span class="text-3xl mb-1">+</span>
                        <span class="text-xs text-gray-500">–î–æ–±–∞–≤–∏—Ç—å</span>
                    </div>
                </div>
            </div>

            <!-- Settings Menu -->
            <div class="bg-white rounded-2xl shadow-sm overflow-hidden mb-20">
                <button onclick="showSettings()" class="w-full p-4 flex items-center justify-between hover:bg-gray-50 border-b border-gray-100">
                    <span class="flex items-center gap-3">
                        <span class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center">‚öôÔ∏è</span>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    </span>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
                <button onclick="exportData()" class="w-full p-4 flex items-center justify-between hover:bg-gray-50 border-b border-gray-100">
                    <span class="flex items-center gap-3">
                        <span class="w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center">üì§</span>
                        <span>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                    </span>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
                <button onclick="showAchievements()" class="w-full p-4 flex items-center justify-between hover:bg-gray-50 border-b border-gray-100">
                    <span class="flex items-center gap-3">
                        <span class="w-10 h-10 bg-yellow-100 rounded-xl flex items-center justify-center">üèÜ</span>
                        <span>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
                    </span>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
                <button onclick="showHelp()" class="w-full p-4 flex items-center justify-between hover:bg-gray-50">
                    <span class="flex items-center gap-3">
                        <span class="w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center">‚ùì</span>
                        <span>–ü–æ–º–æ—â—å</span>
                    </span>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav fixed bottom-0 left-0 right-0 border-t border-gray-200 px-2 py-2 z-50">
        <div class="flex justify-around">
            <button onclick="navigateTo('home')" class="bottom-nav-item flex flex-col items-center gap-1 py-2 px-3 rounded-xl tab-active">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
                <span class="text-[10px] font-medium">–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button onclick="navigateTo('recipes')" class="bottom-nav-item flex flex-col items-center gap-1 py-2 px-3 rounded-xl tab-inactive">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                </svg>
                <span class="text-[10px] font-medium">–†–µ—Ü–µ–ø—Ç—ã</span>
            </button>
            <button onclick="navigateTo('planner')" class="bottom-nav-item flex flex-col items-center gap-1 py-2 px-3 rounded-xl tab-inactive relative">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span class="text-[10px] font-medium">–ü–ª–∞–Ω</span>
                <span id="plannerBadge" class="hidden absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-[10px] text-white flex items-center justify-center">!</span>
            </button>
            <button onclick="navigateTo('shopping')" class="bottom-nav-item flex flex-col items-center gap-1 py-2 px-3 rounded-xl tab-inactive">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                <span class="text-[10px] font-medium">–ü–æ–∫—É–ø–∫–∏</span>
            </button>
            <button onclick="navigateTo('community')" class="bottom-nav-item flex flex-col items-center gap-1 py-2 px-3 rounded-xl tab-inactive">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                <span class="text-[10px] font-medium">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</span>
            </button>
        </div>
    </nav>

    <!-- Recipe Detail Modal -->
    <div id="recipeModal" class="hidden fixed inset-0 bg-black/60 z-50 flex items-end">
        <div class="modal-overlay w-full bg-white rounded-t-[32px] max-h-[92vh] overflow-y-auto slide-up">
            <!-- Drag Handle -->
            <div class="sticky top-0 bg-white border-b border-gray-100 p-4 flex items-center justify-between z-10">
                <div class="w-20"></div>
                <div class="w-32 h-1 bg-gray-200 rounded-full"></div>
                <button onclick="closeRecipeModal()" class="p-2 bg-gray-100 rounded-full">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div id="recipeModalContent">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

    <!-- Cooking Mode Overlay -->
    <div id="cookingMode" class="hidden cooking-mode">
        <div class="flex items-center justify-between mb-6">
            <button onclick="exitCookingMode()" class="p-3 bg-white/10 rounded-xl">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
            <h2 id="cookingRecipeName" class="font-bold text-lg truncate px-4">–†–µ—Ü–µ–ø—Ç</h2>
            <button onclick="toggleCookingVoice()" id="cookingVoiceBtn" class="p-3 bg-white/10 rounded-xl">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                </svg>
            </button>
        </div>
        
        <!-- Timer Section -->
        <div id="cookingTimer" class="hidden mb-6 text-center">
            <div class="relative w-48 h-48 mx-auto">
                <svg class="progress-ring w-48 h-48" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="6"/>
                    <circle id="timerProgress" cx="50" cy="50" r="45" fill="none" stroke="#10b981" stroke-width="6" stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round"/>
                </svg>
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                    <span id="timerDisplay" class="text-4xl font-bold">00:00</span>
                    <span class="text-sm opacity-60" id="timerLabel">–¢–∞–π–º–µ—Ä</span>
                </div>
            </div>
            <div class="flex justify-center gap-3 mt-4">
                <button onclick="startTimer()" class="px-6 py-2 bg-emerald-500 rounded-xl font-medium">–°—Ç–∞—Ä—Ç</button>
                <button onclick="pauseTimer()" class="px-6 py-2 bg-white/20 rounded-xl font-medium">–ü–∞—É–∑–∞</button>
                <button onclick="resetTimer()" class="px-6 py-2 bg-white/20 rounded-xl font-medium">–°–±—Ä–æ—Å</button>
            </div>
        </div>
        
        <!-- Step Navigation -->
        <div class="flex justify-center gap-2 mb-6 overflow-x-auto pb-2" id="stepIndicators">
            <!-- Dynamic -->
        </div>
        
        <!-- Current Step -->
        <div id="cookingStep" class="mb-6">
            <div class="text-center mb-4">
                <span id="cookingStepNumber" class="text-sm bg-emerald-500 px-3 py-1 rounded-full">–®–∞–≥ 1/5</span>
            </div>
            <p id="cookingStepText" class="text-xl text-center leading-relaxed">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è...</p>
        </div>
        
        <!-- Navigation -->
        <div class="flex justify-between items-center">
            <button onclick="prevCookingStep()" class="p-4 bg-white/10 rounded-xl flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                –ù–∞–∑–∞–¥
            </button>
            
            <button onclick="toggleCookingStepComplete()" id="stepCompleteBtn" class="px-6 py-3 bg-emerald-500 rounded-xl font-bold flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                –ì–æ—Ç–æ–≤–æ
            </button>
            
            <button onclick="nextCookingStep()" class="p-4 bg-white/10 rounded-xl flex items-center gap-2">
                –î–∞–ª–µ–µ
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Add Recipe Modal -->
    <div id="addRecipeModal" class="hidden fixed inset-0 bg-black/60 z-50 flex items-end">
        <div class="modal-overlay w-full bg-white rounded-t-[32px] max-h-[92vh] overflow-y-auto slide-up p-4">
            <div class="w-32 h-1 bg-gray-200 rounded-full mx-auto mb-4"></div>
            <h2 class="text-xl font-bold mb-4">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</h2>
            <form id="addRecipeForm" onsubmit="saveRecipe(event)">
                <input type="text" id="newRecipeName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞ *" 
                    class="w-full px-4 py-4 border border-gray-200 rounded-2xl mb-3 focus:outline-none focus:ring-2 focus:ring-emerald-500" required>
                
                <textarea id="newRecipeDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –±–ª—é–¥–∞..." 
                    class="w-full px-4 py-4 border border-gray-200 rounded-2xl mb-3 focus:outline-none focus:ring-2 focus:ring-emerald-500" rows="2"></textarea>
                
                <div class="grid grid-cols-3 gap-2 mb-3">
                    <input type="number" id="newRecipeTime" placeholder="–í—Ä–µ–º—è (–º–∏–Ω) *" 
                        class="px-4 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500" required>
                    <input type="number" id="newRecipeCalories" placeholder="–ö–∫–∞–ª" 
                        class="px-4 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500">
                    <select id="newRecipeDifficulty" class="px-4 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        <option value="easy">–õ–µ–≥–∫–æ</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–µ</option>
                        <option value="hard">–°–ª–æ–∂–Ω–æ</option>
                    </select>
                </div>
                
                <div class="mb-3">
                    <label class="block text-sm text-gray-500 mb-2">–§–æ—Ç–æ –±–ª—é–¥–∞</label>
                    <div class="flex items-center gap-3 p-4 border-2 border-dashed border-gray-200 rounded-2xl" onclick="document.getElementById('photoInput').click()">
                        <div class="w-16 h-16 bg-gray-100 rounded-xl flex items-center justify-center text-2xl">
                            üì∑
                        </div>
                        <div class="flex-1">
                            <p class="font-medium">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</p>
                            <p class="text-sm text-gray-500">JPG, PNG –¥–æ 10–ú–ë</p>
                        </div>
                    </div>
                    <input type="file" id="photoInput" accept="image/*" class="hidden">
                </div>
                
                <div class="mb-3">
                    <label class="block text-sm text-gray-500 mb-2">–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (–∫–∞–∂–¥—ã–π —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)</label>
                    <textarea id="newRecipeIngredients" rows="5" 
                        placeholder="500–≥ –∫—É—Ä–∏—Ü—ã&#10;2 –ª—É–∫–æ–≤–∏—Ü—ã&#10;3 –∑—É–±—á–∏–∫–∞ —á–µ—Å–Ω–æ–∫–∞" 
                        class="w-full px-4 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500"></textarea>
                    <p class="text-xs text-gray-400 mt-1">–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è 1 –ø–æ—Ä—Ü–∏–∏</p>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm text-gray-500 mb-2">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —à–∞–≥–∞–º</label>
                    <textarea id="newRecipeSteps" rows="5" 
                        placeholder="1. –ù–∞—Ä–µ–∑–∞—Ç—å –∫—É—Ä–∏—Ü—É...&#10;2. –û–±–∂–∞—Ä–∏—Ç—å –ª—É–∫..." 
                        class="w-full px-4 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500"></textarea>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm text-gray-500 mb-2">–¢–µ–≥–∏</label>
                    <div class="flex flex-wrap gap-2">
                        <button type="button" onclick="toggleRecipeTag('breakfast')" class="recipe-tag px-3 py-1 border border-gray-200 rounded-full text-sm" data-tag="breakfast">üç≥ –ó–∞–≤—Ç—Ä–∞–∫</button>
                        <button type="button" onclick="toggleRecipeTag('lunch')" class="recipe-tag px-3 py-1 border border-gray-200 rounded-full text-sm" data-tag="lunch">ü•ó –û–±–µ–¥</button>
                        <button type="button" onclick="toggleRecipeTag('dinner')" class="recipe-tag px-3 py-1 border border-gray-200 rounded-full text-sm" data-tag="dinner">üçΩÔ∏è –£–∂–∏–Ω</button>
                        <button type="button" onclick="toggleRecipeTag('dessert')" class="recipe-tag px-3 py-1 border border-gray-200 rounded-full text-sm" data-tag="dessert">üç∞ –î–µ—Å–µ—Ä—Ç</button>
                        <button type="button" onclick="toggleRecipeTag('healthy')" class="recipe-tag px-3 py-1 border border-gray-200 rounded-full text-sm" data-tag="healthy">üí™ –ü–ü</button>
                        <button type="button" onclick="toggleRecipeTag('vegan')" class="recipe-tag px-3 py-1 border border-gray-200 rounded-full text-sm" data-tag="vegan">üå± –í–µ–≥–∞–Ω</button>
                    </div>
                </div>
                
                <div class="flex gap-2 mb-6">
                    <button type="button" onclick="closeAddRecipeModal()" class="flex-1 py-4 border-2 border-gray-200 rounded-2xl font-bold">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="flex-1 py-4 btn-primary text-white rounded-2xl font-bold">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Post Modal -->
    <div id="createPostModal" class="hidden fixed inset-0 bg-black/60 z-50 flex items-end">
        <div class="modal-overlay w-full bg-white rounded-t-[32px] max-h-[90vh] overflow-y-auto slide-up p-4">
            <div class="w-32 h-1 bg-gray-200 rounded-full mx-auto mb-4"></div>
            <h2 class="text-xl font-bold mb-4">–°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é</h2>
            
            <div class="space-y-4">
                <textarea id="postContent" placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ä–µ—Ü–µ–ø—Ç–æ–º –∏–ª–∏ —Å–æ–≤–µ—Ç–æ–º..." 
                    class="w-full px-4 py-4 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500" rows="4"></textarea>
                
                <div class="flex items-center gap-3 p-4 border-2 border-dashed border-gray-200 rounded-2xl" onclick="document.getElementById('postPhotoInput').click()">
                    <div class="w-14 h-14 bg-gray-100 rounded-xl flex items-center justify-center text-2xl">
                        üì∑
                    </div>
                    <div class="flex-1">
                        <p class="font-medium">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</p>
                        <p class="text-sm text-gray-500">–∏–ª–∏ –≤–∏–¥–µ–æ</p>
                    </div>
                </div>
                <input type="file" id="postPhotoInput" accept="image/*,video/*" class="hidden">
                
                <!-- Recipe Link -->
                <div class="p-3 bg-gray-100 rounded-xl flex items-center gap-2">
                    <span class="text-xl">üç≥</span>
                    <span class="flex-1">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</span>
                    <button onclick="attachRecipeToPost()" class="text-emerald-600 font-medium text-sm">–í—ã–±—Ä–∞—Ç—å</button>
                </div>
                
                <div class="flex gap-2">
                    <button type="button" onclick="closeCreatePostModal()" class="flex-1 py-4 border-2 border-gray-200 rounded-2xl font-bold">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" onclick="publishPost()" class="flex-1 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl font-bold">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Achievements Modal -->
    <div id="achievementsModal" class="hidden fixed inset-0 bg-black/60 z-50 flex items-end">
        <div class="modal-overlay w-full bg-white rounded-t-[32px] max-h-[90vh] overflow-y-auto slide-up p-4">
            <div class="w-32 h-1 bg-gray-200 rounded-full mx-auto mb-4"></div>
            <h2 class="text-xl font-bold mb-4">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
            
            <div class="grid grid-cols-3 gap-3 mb-4">
                <div class="achievement-badge text-center p-3 bg-gradient-to-br from-yellow-100 to-orange-100 rounded-xl">
                    <div class="text-3xl mb-1">üî•</div>
                    <div class="text-xs font-bold">7 –¥–Ω–µ–π</div>
                </div>
                <div class="achievement-badge text-center p-3 bg-gradient-to-br from-green-100 to-emerald-100 rounded-xl">
                    <div class="text-3xl mb-1">üë®‚Äçüç≥</div>
                    <div class="text-xs font-bold">–ü–æ–≤–∞—Ä</div>
                </div>
                <div class="achievement-badge text-center p-3 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-xl opacity-50">
                    <div class="text-3xl mb-1">üìö</div>
                    <div class="text-xs font-bold">–ê–≤—Ç–æ—Ä</div>
                </div>
                <div class="achievement-badge text-center p-3 bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl opacity-50">
                    <div class="text-3xl mb-1">‚≠ê</div>
                    <div class="text-xs font-bold">–≠–∫—Å–ø–µ—Ä—Ç</div>
                </div>
                <div class="achievement-badge text-center p-3 bg-gradient-to-br from-red-100 to-pink-100 rounded-xl opacity-50">
                    <div class="text-3xl mb-1">‚ù§Ô∏è</div>
                    <div class="text-xs font-bold">–õ—é–±–∏–º–µ—Ü</div>
                </div>
                <div class="achievement-badge text-center p-3 bg-gradient-to-br from-cyan-100 to-blue-100 rounded-xl opacity-50">
                    <div class="text-3xl mb-1">üíß</div>
                    <div class="text-xs font-bold">–í–æ–¥–æ—Ö–ª—ë–±</div>
                </div>
            </div>
            
            <button onclick="closeAchievementsModal()" class="w-full py-4 bg-gray-100 rounded-2xl font-bold">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- Voice Command Overlay -->
    <div id="voiceOverlay" class="hidden fixed inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 z-50 flex items-center justify-center">
        <div class="text-center text-white p-8">
            <div class="relative w-48 h-48 mx-auto mb-8">
                <div class="absolute inset-0 bg-emerald-500/30 rounded-full pulse-ring"></div>
                <div class="absolute inset-4 bg-emerald-500/50 rounded-full pulse-ring" style="animation-delay: 0.3s"></div>
                <div class="absolute inset-8 bg-emerald-500 rounded-full flex items-center justify-center">
                    <div class="flex gap-1 h-16 items-end">
                        <span class="voice-wave w-3 bg-white rounded"></span>
                        <span class="voice-wave w-3 h-10 bg-white rounded delay-75"></span>
                        <span class="voice-wave w-3 h-6 bg-white rounded delay-150"></span>
                        <span class="voice-wave w-3 h-12 bg-white rounded delay-100"></span>
                        <span class="voice-wave w-3 h-8 bg-white rounded delay-200"></span>
                        <span class="voice-wave w-3 h-10 bg-white rounded delay-75"></span>
                        <span class="voice-wave w-3 bg-white rounded delay-150"></span>
                    </div>
                </div>
            </div>
            <p class="text-2xl font-bold mb-2" id="voiceStatus2">–°–ª—É—à–∞—é...</p>
            <p class="text-lg text-gray-400 mb-2" id="voiceResult2">–°–∫–∞–∂–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É</p>
            <p class="text-sm text-gray-500 mb-8">¬´–ù–∞–π–¥–∏ —Ä–µ—Ü–µ–ø—Ç –ø–∞—Å—Ç—ã¬ª, ¬´–°–æ–∑–¥–∞–π –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é¬ª</p>
            <button onclick="stopVoiceMode()" class="px-8 py-4 bg-red-500 rounded-full font-bold text-lg shadow-xl shadow-red-500/30">
                –û—Ç–º–µ–Ω–∞
            </button>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="hidden fixed top-24 left-4 right-4 bg-gray-900 text-white px-4 py-4 rounded-2xl z-50 text-center slide-up shadow-xl">
        <span id="toastMessage"></span>
    </div>

    <!-- Install Prompt -->
    <div id="installPrompt" class="hidden fixed bottom-24 left-4 right-4 bg-gradient-to-r from-emerald-500 to-teal-500 text-white p-4 rounded-2xl shadow-xl z-50 slide-up">
        <div class="flex items-center gap-3">
            <span class="text-3xl">üì±</span>
            <div class="flex-1">
                <p class="font-bold">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
                <p class="text-sm opacity-90">–î–æ–±–∞–≤—å—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</p>
            </div>
            <button onclick="dismissInstallPrompt()" class="p-2 bg-white/20 rounded-lg">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
        <button onclick="installPWA()" class="w-full mt-3 py-3 bg-white text-emerald-600 rounded-xl font-bold">
            –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
        </button>
    </div>

    <script>
        // ============================================
        // DATA & STATE
        // ============================================
        // –ö–∞—Ä—Ç–∞ –∫—Ä–∞—Å–∏–≤—ã—Ö —Ñ–æ—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ü–µ–ø—Ç–∞ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–∏ URL)
        // –°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–±–æ—Ä–∫–∏ —Å Unsplash (–ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –µ–¥—ã)
        function getRecipePhoto(id) {
            const map = {
                1: 'https://source.unsplash.com/800x600/?pasta', // –ø–∞—Å—Ç–∞ –∫–∞—Ä–±–æ–Ω–∞—Ä–∞
                2: 'https://source.unsplash.com/800x600/?avocado,toast', // –∞–≤–æ–∫–∞–¥–æ-—Ç–æ—Å—Ç
                3: 'https://source.unsplash.com/800x600/?caesar-salad', // —Å–∞–ª–∞—Ç —Ü–µ–∑–∞—Ä—å
                4: 'https://source.unsplash.com/800x600/?chocolate,dessert', // —à–æ–∫–æ–ª–∞–¥–Ω—ã–π –º—É—Å—Å
                5: 'https://source.unsplash.com/800x600/?chicken,soup', // –∫—É—Ä–∏–Ω—ã–π —Å—É–ø
                6: 'https://source.unsplash.com/800x600/?smoothie,bowl', // —Å–º—É–∑–∏ –±–æ—É–ª
                7: 'https://source.unsplash.com/800x600/?salmon,grilled', // –ª–æ—Å–æ—Å—å
                8: 'https://source.unsplash.com/800x600/?vegetable,stew', // –æ–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É
                9: 'https://source.unsplash.com/800x600/?ramen,noodles', // —Ä–∞–º–µ–Ω
                10: 'https://source.unsplash.com/800x600/?tiramisu,dessert', // —Ç–∏—Ä–∞–º–∏—Å—É
                11: 'https://source.unsplash.com/800x600/?falafel', // —Ñ–∞–ª–∞—Ñ–µ–ª—å
                12: 'https://source.unsplash.com/800x600/?greek,salad', // –≥—Ä–µ—á–µ—Å–∫–∏–π —Å–∞–ª–∞—Ç
                13: 'https://source.unsplash.com/800x600/?pancakes,breakfast', // –ø–∞–Ω–∫–µ–π–∫–∏
                14: 'https://source.unsplash.com/800x600/?tacos', // —Ç–∞–∫–æ
                15: 'https://source.unsplash.com/800x600/?kimchi', // –∫–∏–º—á–∏
                100: 'https://source.unsplash.com/800x600/?buddha,bowl', // –±–æ—É–ª —Å –ª–æ—Å–æ—Å–µ–º
                101: 'https://source.unsplash.com/800x600/?oatmeal,pancakes', // –ø–ø –æ–ª–∞–¥—å–∏
                102: 'https://source.unsplash.com/800x600/?pumpkin,soup', // –∫—Ä–µ–º-—Å—É–ø –∏–∑ —Ç—ã–∫–≤—ã
                103: 'https://source.unsplash.com/800x600/?shakshuka,eggs', // —à–∞–∫—à—É–∫–∞
                104: 'https://source.unsplash.com/800x600/?sushi,vegan', // —Ä–æ–ª–ª—ã —Å —Ç–æ—Ñ—É
                105: 'https://source.unsplash.com/800x600/?turkey,roast', // –∏–Ω–¥–µ–π–∫–∞ —Å –æ–≤–æ—â–∞–º–∏
                106: 'https://source.unsplash.com/800x600/?blueberry,muffins'  // –º–∞—Ñ—Ñ–∏–Ω—ã —Å —á–µ—Ä–Ω–∏–∫–æ–π
            };
            // –û–±—â–∏–π –∫—Ä–∞—Å–∏–≤—ã–π —Ñ—É–¥-—Ñ–æ—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            return map[id] || 'https://source.unsplash.com/800x600/?food,healthy';
        }

        let recipes = [
            {
                id: 1, name: "–ü–∞—Å—Ç–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏—Ç–∞–ª—å—è–Ω—Å–∫–∞—è –ø–∞—Å—Ç–∞ —Å –±–µ–∫–æ–Ω–æ–º –∏ —Å–ª–∏–≤–æ—á–Ω—ã–º —Å–æ—É—Å–æ–º",
                image: "üçù", time: 25, calories: 450, difficulty: "medium", category: "dinner", kitchen: "italian",
                protein: 18, fats: 22, carbs: 45, rating: 4.8, reviews: 234, cookCount: 1560,
                tags: ["–∏—Ç–∞–ª—å—è–Ω—Å–∫–∞—è", "–ø–∞—Å—Ç–∞", "–±—ã—Å—Ç—Ä–æ", "—Å—ã—Ç–Ω—ã–π"],
                ingredients: ["400–≥ —Å–ø–∞–≥–µ—Ç—Ç–∏", "200–≥ –±–µ–∫–æ–Ω–∞", "3 —è–π—Ü–∞", "100–≥ –ø–∞—Ä–º–µ–∑–∞–Ω–∞", "–ß–µ—Ä–Ω—ã–π –ø–µ—Ä–µ—Ü"],
                steps: ["–û—Ç–≤–∞—Ä–∏—Ç–µ —Å–ø–∞–≥–µ—Ç—Ç–∏ –¥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–ª—å –¥–µ–Ω—Ç–µ", "–û–±–∂–∞—Ä—å—Ç–µ –±–µ–∫–æ–Ω –¥–æ —Ö—Ä—É—Å—Ç—è—â–µ–π –∫–æ—Ä–æ—á–∫–∏", "–°–º–µ—à–∞–π—Ç–µ —è–π—Ü–∞ —Å —Ç–µ—Ä—Ç—ã–º –ø–∞—Ä–º–µ–∑–∞–Ω–æ–º", "–°–ª–µ–π—Ç–µ –≤–æ–¥—É, –æ—Å—Ç–∞–≤–∏–≤ –Ω–µ–º–Ω–æ–≥–æ –∫—Ä–∞—Ö–º–∞–ª—å–Ω–æ–π –≤–æ–¥—ã", "–ë—ã—Å—Ç—Ä–æ —Å–º–µ—à–∞–π—Ç–µ –ø–∞—Å—Ç—É —Å –±–µ–∫–æ–Ω–æ–º –∏ —è–∏—á–Ω–æ–π —Å–º–µ—Å—å—é"],
                isFavorite: false, cooked: false
            },
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã
            {
                id: 100, name: "–ë–æ—É–ª —Å –ª–æ—Å–æ—Å–µ–º –∏ –∫–∏–Ω–æ–∞", description: "–ü–ü-–±–æ—É–ª —Å –∫–∏–Ω–æ–∞, –ª–æ—Å–æ—Å–µ–º –∏ –æ–≤–æ—â–∞–º–∏",
                image: "ü•ó", time: 20, calories: 420, difficulty: "easy", category: "healthy", kitchen: "fusion",
                protein: 28, fats: 16, carbs: 35, rating: 4.9, reviews: 120, cookCount: 980,
                tags: ["–±–æ—É–ª", "–ø–ø", "–∑–¥–æ—Ä–æ–≤—ã–π", "—Ä—ã–±–∞"],
                ingredients: ["100–≥ –∫–∏–Ω–æ–∞", "120–≥ –ª–æ—Å–æ—Å—è", "1 –æ–≥—É—Ä–µ—Ü", "1 –∞–≤–æ–∫–∞–¥–æ", "–°–æ–µ–≤—ã–π —Å–æ—É—Å", "–õ–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫"],
                steps: ["–û—Ç–≤–∞—Ä–∏—Ç–µ –∫–∏–Ω–æ–∞ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏", "–û–±–∂–∞—Ä—å—Ç–µ –ª–æ—Å–æ—Å—è –Ω–∞ —Å–∫–æ–≤–æ—Ä–æ–¥–µ-–≥—Ä–∏–ª—å", "–ù–∞—Ä–µ–∂—å—Ç–µ –æ–≤–æ—â–∏ –∫—Ä—É–ø–Ω—ã–º–∏ –∫—É—Å–æ—á–∫–∞–º–∏", "–°–æ–±–µ—Ä–∏—Ç–µ –±–æ—É–ª: –∫–∏–Ω–æ–∞, –æ–≤–æ—â–∏, –ª–æ—Å–æ—Å—å", "–ü–æ–ª–µ–π—Ç–µ —Å–æ—É—Å–æ–º"],
                isFavorite: false, cooked: false
            },
            {
                id: 101, name: "–ü–ü –æ–ª–∞–¥—å–∏ –∏–∑ –æ–≤—Å—è–Ω–∫–∏", description: "–ù–∏–∑–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω—ã–µ –æ–ª–∞–¥—å–∏ –±–µ–∑ —Å–∞—Ö–∞—Ä–∞",
                image: "ü•û", time: 15, calories: 220, difficulty: "easy", category: "breakfast", kitchen: "healthy",
                protein: 12, fats: 5, carbs: 32, rating: 4.7, reviews: 98, cookCount: 760,
                tags: ["–ø–ø", "–∑–∞–≤—Ç—Ä–∞–∫", "–æ–≤—Å—è–Ω–∫–∞"],
                ingredients: ["60–≥ –æ–≤—Å—è–Ω—ã—Ö —Ö–ª–æ–ø—å–µ–≤", "1 –±–∞–Ω–∞–Ω", "1 —è–π—Ü–æ", "–ö–æ—Ä–∏—Ü–∞", "–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –º–∞—Å–ª–æ –¥–ª—è –∂–∞—Ä–∫–∏"],
                steps: ["–ò–∑–º–µ–ª—å—á–∏—Ç–µ –æ–≤—Å—è–Ω–∫—É –≤ –º—É–∫—É", "–î–æ–±–∞–≤—å—Ç–µ –±–∞–Ω–∞–Ω –∏ —è–π—Ü–æ, –≤–∑–±–µ–π—Ç–µ", "–î–æ–±–∞–≤—å—Ç–µ –∫–æ—Ä–∏—Ü—É", "–ñ–∞—Ä—å—Ç–µ –Ω–µ–±–æ–ª—å—à–∏–µ –æ–ª–∞–¥—å–∏ –Ω–∞ —Å–∫–æ–≤–æ—Ä–æ–¥–µ"],
                isFavorite: false, cooked: false
            },
            {
                id: 102, name: "–ö—Ä–µ–º-—Å—É–ø –∏–∑ —Ç—ã–∫–≤—ã", description: "–ù–µ–∂–Ω—ã–π –æ—Å–µ–Ω–Ω–∏–π —Å—É–ø-–ø—é—Ä–µ",
                image: "üéÉ", time: 35, calories: 260, difficulty: "easy", category: "dinner", kitchen: "european",
                protein: 6, fats: 12, carbs: 30, rating: 4.8, reviews: 210, cookCount: 1500,
                tags: ["—Å—É–ø", "—Ç—ã–∫–≤–∞", "–æ—Å–µ–Ω—å", "–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–π"],
                ingredients: ["500–≥ —Ç—ã–∫–≤—ã", "1 –º–æ—Ä–∫–æ–≤—å", "1 –ª—É–∫–æ–≤–∏—Ü–∞", "200–º–ª —Å–ª–∏–≤–æ–∫", "–û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ", "–°–æ–ª—å, –ø–µ—Ä–µ—Ü"],
                steps: ["–ù–∞—Ä–µ–∂—å—Ç–µ –æ–≤–æ—â–∏ –∫—É–±–∏–∫–∞–º–∏", "–û–±–∂–∞—Ä—å—Ç–µ –ª—É–∫ –∏ –º–æ—Ä–∫–æ–≤—å", "–î–æ–±–∞–≤—å—Ç–µ —Ç—ã–∫–≤—É –∏ –≤–æ–¥—É, —Ç—É—à–∏—Ç–µ –¥–æ –º—è–≥–∫–æ—Å—Ç–∏", "–ü—é—Ä–∏—Ä—É–π—Ç–µ –±–ª–µ–Ω–¥–µ—Ä–æ–º, –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–∏–≤–∫–∏"],
                isFavorite: false, cooked: false
            },
            {
                id: 103, name: "–®–∞–∫—à—É–∫–∞", description: "–Ø–π—Ü–∞, —Ç—É—à—ë–Ω–Ω—ã–µ –≤ —Ç–æ–º–∞—Ç–Ω–æ–º —Å–æ—É—Å–µ —Å –æ–≤–æ—â–∞–º–∏",
                image: "üç≥", time: 25, calories: 330, difficulty: "medium", category: "breakfast", kitchen: "middle-eastern",
                protein: 16, fats: 22, carbs: 18, rating: 4.9, reviews: 260, cookCount: 1980,
                tags: ["–∑–∞–≤—Ç—Ä–∞–∫", "—è–π—Ü–∞", "—Ç–æ–º–∞—Ç–Ω—ã–π —Å–æ—É—Å", "–æ—Å—Ç—Ä–æ–µ"],
                ingredients: ["4 —è–π—Ü–∞", "2 –±–æ–ª–≥–∞—Ä—Å–∫–∏—Ö –ø–µ—Ä—Ü–∞", "1 –ª—É–∫–æ–≤–∏—Ü–∞", "400–≥ —Ç–æ–º–∞—Ç–æ–≤", "–ß–µ—Å–Ω–æ–∫", "–°–ø–µ—Ü–∏–∏"],
                steps: ["–û–±–∂–∞—Ä—å—Ç–µ –ª—É–∫ –∏ –ø–µ—Ä–µ—Ü", "–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–º–∞—Ç—ã –∏ —Å–ø–µ—Ü–∏–∏, —Ç—É—à–∏—Ç–µ", "–°–¥–µ–ª–∞–π—Ç–µ –ª—É–Ω–∫–∏ –∏ –≤–±–µ–π—Ç–µ —è–π—Ü–∞", "–ì–æ—Ç–æ–≤—å—Ç–µ –¥–æ –∂–µ–ª–∞–µ–º–æ–π —Å—Ç–µ–ø–µ–Ω–∏"],
                isFavorite: false, cooked: false
            },
            {
                id: 104, name: "–†–æ–ª–ª—ã —Å –æ–≤–æ—â–∞–º–∏ –∏ —Ç–æ—Ñ—É", description: "–í–µ–≥–∞–Ω—Å–∫–∏–µ —Ä–æ–ª–ª—ã —Å —Ä–∏—Å–æ–º –∏ —Å–≤–µ–∂–∏–º–∏ –æ–≤–æ—â–∞–º–∏",
                image: "üç£", time: 40, calories: 300, difficulty: "hard", category: "dinner", kitchen: "asian",
                protein: 14, fats: 8, carbs: 48, rating: 4.6, reviews: 130, cookCount: 640,
                tags: ["–≤–µ–≥–∞–Ω", "—Ä–æ–ª–ª—ã", "—Ä–∏—Å", "–æ–≤–æ—â–∏"],
                ingredients: ["–õ–∏—Å—Ç—ã –Ω–æ—Ä–∏", "200–≥ —Ä–∏—Å–∞ –¥–ª—è —Å—É—à–∏", "150–≥ —Ç–æ—Ñ—É", "–û–≥—É—Ä–µ—Ü", "–ú–æ—Ä–∫–æ–≤—å", "–°–æ–µ–≤—ã–π —Å–æ—É—Å"],
                steps: ["–û—Ç–≤–∞—Ä–∏—Ç–µ —Ä–∏—Å –∏ –æ—Å—Ç—É–¥–∏—Ç–µ", "–ù–∞—Ä–µ–∂—å—Ç–µ –æ–≤–æ—â–∏ –∏ —Ç–æ—Ñ—É –ø–æ–ª–æ—Å–∫–∞–º–∏", "–í—ã–ª–æ–∂–∏—Ç–µ —Ä–∏—Å –Ω–∞ –Ω–æ—Ä–∏", "–î–æ–±–∞–≤—å—Ç–µ –Ω–∞—á–∏–Ω–∫—É –∏ —Å–≤–µ—Ä–Ω–∏—Ç–µ —Ä—É–ª–µ—Ç", "–ù–∞—Ä–µ–∂—å—Ç–µ —Ä–æ–ª–ª—ã"],
                isFavorite: false, cooked: false
            },
            {
                id: 105, name: "–ó–∞–ø–µ—á—ë–Ω–Ω–∞—è –∏–Ω–¥–µ–π–∫–∞ —Å –æ–≤–æ—â–∞–º–∏", description: "–ü–ü-—É–∂–∏–Ω –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏",
                image: "üçó", time: 50, calories: 380, difficulty: "medium", category: "family", kitchen: "european",
                protein: 32, fats: 14, carbs: 26, rating: 4.8, reviews: 175, cookCount: 900,
                tags: ["—Å–µ–º–µ–π–Ω—ã–π", "–∑–∞–ø–µ–∫–∞–Ω–∏–µ", "–∏–Ω–¥–µ–π–∫–∞", "–ø—Ä–∞–∑–¥–Ω–∏–∫"],
                ingredients: ["600–≥ –∏–Ω–¥–µ–π–∫–∏", "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å", "–ú–æ—Ä–∫–æ–≤—å", "–ß–µ—Å–Ω–æ–∫", "–û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ", "–°–ø–µ—Ü–∏–∏"],
                steps: ["–ù–∞—Ä–µ–∂—å—Ç–µ –∏–Ω–¥–µ–π–∫—É –∏ –æ–≤–æ—â–∏", "–ó–∞–º–∞—Ä–∏–Ω—É–π—Ç–µ –≤ —Å–ø–µ—Ü–∏—è—Ö –∏ –º–∞—Å–ª–µ", "–ó–∞–ø–µ–∫–∞–π—Ç–µ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏"],
                isFavorite: false, cooked: false
            },
            {
                id: 106, name: "–ú–∞—Ñ—Ñ–∏–Ω—ã —Å —á–µ—Ä–Ω–∏–∫–æ–π", description: "–í–æ–∑–¥—É—à–Ω—ã–µ –º–∞—Ñ—Ñ–∏–Ω—ã –∫ —á–∞—é",
                image: "ü´ê", time: 30, calories: 290, difficulty: "easy", category: "desserts", kitchen: "european",
                protein: 6, fats: 10, carbs: 42, rating: 4.7, reviews: 145, cookCount: 830,
                tags: ["–≤—ã–ø–µ—á–∫–∞", "—á–µ—Ä–Ω–∏–∫–∞", "–¥–µ—Å–µ—Ä—Ç", "–¥–µ—Ç–∏"],
                ingredients: ["200–≥ –º—É–∫–∏", "2 —è–π—Ü–∞", "100–≥ —Å–∞—Ö–∞—Ä–∞", "100–º–ª –º–æ–ª–æ–∫–∞", "–†–∞–∑—Ä—ã—Ö–ª–∏—Ç–µ–ª—å", "–ß–µ—Ä–Ω–∏–∫–∞"],
                steps: ["–°–º–µ—à–∞–π—Ç–µ —Å—É—Ö–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã", "–î–æ–±–∞–≤—å—Ç–µ —è–π—Ü–∞ –∏ –º–æ–ª–æ–∫–æ", "–í–º–µ—à–∞–π—Ç–µ —è–≥–æ–¥—ã", "–í—ã–ø–µ–∫–∞–π—Ç–µ –≤ —Ñ–æ—Ä–º–∞—Ö"],
                isFavorite: false, cooked: false
            },

            {
                id: 2, name: "–ê–≤–æ–∫–∞–¥–æ-—Ç–æ—Å—Ç —Å —è–π—Ü–æ–º", description: "–ü–æ–ª–µ–∑–Ω—ã–π –∏ —Å—ã—Ç–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫ –∑–∞ 10 –º–∏–Ω—É—Ç",
                image: "ü•ë", time: 10, calories: 320, difficulty: "easy", category: "breakfast", kitchen: "american",
                protein: 12, fats: 18, carbs: 28, rating: 4.9, reviews: 567, cookCount: 3420,
                tags: ["–∑–¥–æ—Ä–æ–≤—ã–π", "–∑–∞–≤—Ç—Ä–∞–∫", "–≤–µ–≥–∞–Ω"],
                ingredients: ["2 –ª–æ–º—Ç–∏–∫–∞ —Ö–ª–µ–±–∞", "1 —Å–ø–µ–ª–æ–µ –∞–≤–æ–∫–∞–¥–æ", "2 —è–π—Ü–∞", "–°–æ–ª—å, –ø–µ—Ä–µ—Ü", "–õ–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫"],
                steps: ["–ü–æ–¥–∂–∞—Ä—å—Ç–µ —Ö–ª–µ–± –¥–æ –∑–æ–ª–æ—Ç–∏—Å—Ç–æ–π –∫–æ—Ä–æ—á–∫–∏", "–†–∞–∑—Ä–µ–∂—å—Ç–µ –∞–≤–æ–∫–∞–¥–æ –ø–æ–ø–æ–ª–∞–º –∏ —É–¥–∞–ª–∏—Ç–µ –∫–æ—Å—Ç–æ—á–∫—É", "–†–∞–∑–æ–º–Ω–∏—Ç–µ –∞–≤–æ–∫–∞–¥–æ –≤–∏–ª–∫–æ–π, –¥–æ–±–∞–≤—å—Ç–µ –ª–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫", "–û–±–∂–∞—Ä—å—Ç–µ —è–π—Ü–∞ –Ω–∞ —Å–∫–æ–≤–æ—Ä–æ–¥–µ", "–í—ã–ª–æ–∂–∏—Ç–µ –∞–≤–æ–∫–∞–¥–æ –Ω–∞ —Ö–ª–µ–±, —Å–≤–µ—Ä—Ö—É —è–π—Ü–æ"],
                isFavorite: false, cooked: false
            },
            {
                id: 3, name: "–°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å", description: "–û—Å–≤–µ–∂–∞—é—â–∏–π —Å–∞–ª–∞—Ç —Å –∫—É—Ä–∏—Ü–µ–π –∏ —Ö—Ä—É—Å—Ç—è—â–∏–º–∏ –≥—Ä–µ–Ω–∫–∞–º–∏",
                image: "ü•ó", time: 20, calories: 280, difficulty: "easy", category: "lunch", kitchen: "american",
                protein: 22, fats: 15, carbs: 18, rating: 4.7, reviews: 189, cookCount: 2890,
                tags: ["—Å–∞–ª–∞—Ç", "–∑–¥–æ—Ä–æ–≤—ã–π", "–æ–±–µ–¥", "–∫–ª–∞—Å—Å–∏–∫–∞"],
                ingredients: ["1 –∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞", "1 –∫–æ—á–∞–Ω —Å–∞–ª–∞—Ç–∞ —Ä–æ–º–∞–Ω–æ", "50–≥ –ø–∞—Ä–º–µ–∑–∞–Ω–∞", "100–≥ –≥—Ä–µ–Ω–æ–∫", "–°–æ—É—Å –¶–µ–∑–∞—Ä—å"],
                steps: ["–û–±–∂–∞—Ä—å—Ç–µ –∫—É—Ä–∏–Ω—É—é –≥—Ä—É–¥–∫—É –Ω–∞ –≥—Ä–∏–ª–µ", "–ù–∞—Ä–µ–∂—å—Ç–µ —Å–∞–ª–∞—Ç –∫—Ä—É–ø–Ω—ã–º–∏ –∫—É—Å–æ—á–∫–∞–º–∏", "–î–æ–±–∞–≤—å—Ç–µ –Ω–∞—Ä–µ–∑–∞–Ω–Ω—É—é –∫—É—Ä–∏—Ü—É", "–ü–æ—Å—ã–ø—å—Ç–µ –ø–∞—Ä–º–µ–∑–∞–Ω–æ–º –∏ –≥—Ä–µ–Ω–∫–∞–º–∏", "–ó–∞–ø—Ä–∞–≤—å—Ç–µ —Å–æ—É—Å–æ–º –¶–µ–∑–∞—Ä—å"],
                isFavorite: false, cooked: false
            },
            {
                id: 4, name: "–®–æ–∫–æ–ª–∞–¥–Ω—ã–π –º—É—Å—Å", description: "–ù–µ–∂–Ω—ã–π –¥–µ—Å–µ—Ä—Ç —Å –≤–æ–∑–¥—É—à–Ω–æ–π —Ç–µ–∫—Å—Ç—É—Ä–æ–π",
                image: "üç´", time: 30, calories: 380, difficulty: "medium", category: "desserts", kitchen: "french",
                protein: 8, fats: 25, carbs: 35, rating: 4.9, reviews: 312, cookCount: 980,
                tags: ["–¥–µ—Å–µ—Ä—Ç", "—à–æ–∫–æ–ª–∞–¥", "–ø—Ä–∞–∑–¥–Ω–∏–∫", "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è"],
                ingredients: ["200–≥ —Ç–µ–º–Ω–æ–≥–æ —à–æ–∫–æ–ª–∞–¥–∞", "4 —è–π—Ü–∞", "100–≥ —Å–∞—Ö–∞—Ä–∞", "200–º–ª —Å–ª–∏–≤–æ–∫", "–í–∞–Ω–∏–ª—å"],
                steps: ["–†–∞—Å—Ç–æ–ø–∏—Ç–µ —à–æ–∫–æ–ª–∞–¥ –Ω–∞ –≤–æ–¥—è–Ω–æ–π –±–∞–Ω–µ", "–û—Ç–¥–µ–ª–∏—Ç–µ –±–µ–ª–∫–∏ –æ—Ç –∂–µ–ª—Ç–∫–æ–≤", "–í–∑–±–µ–π—Ç–µ –±–µ–ª–∫–∏ —Å —Å–∞—Ö–∞—Ä–æ–º –¥–æ —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –ø–∏–∫–æ–≤", "–°–º–µ—à–∞–π—Ç–µ —à–æ–∫–æ–ª–∞–¥ —Å –∂–µ–ª—Ç–∫–∞–º–∏", "–ê–∫–∫—É—Ä–∞—Ç–Ω–æ –≤–≤–µ–¥–∏—Ç–µ –±–µ–ª–∫–∏ –≤ —à–æ–∫–æ–ª–∞–¥–Ω—É—é –º–∞—Å—Å—É", "–†–∞–∑–ª–µ–π—Ç–µ –ø–æ —Ñ–æ—Ä–º–æ—á–∫–∞–º –∏ –æ—Ö–ª–∞–¥–∏—Ç–µ 2 —á–∞—Å–∞"],
                isFavorite: false, cooked: false
            },
            {
                id: 5, name: "–ö—É—Ä–∏–Ω—ã–π —Å—É–ø —Å –ª–∞–ø—à–æ–π", description: "–°–æ–≥—Ä–µ–≤–∞—é—â–∏–π –¥–æ–º–∞—à–Ω–∏–π —Å—É–ø –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏",
                image: "üç≤", time: 45, calories: 320, difficulty: "easy", category: "dinner", kitchen: "russian",
                protein: 25, fats: 12, carbs: 32, rating: 4.8, reviews: 445, cookCount: 4530,
                tags: ["—Å—É–ø", "–¥–æ–º–∞—à–Ω–∏–π", "—Å–µ–º–µ–π–Ω—ã–π", "–∫–ª–∞—Å—Å–∏–∫–∞"],
                ingredients: ["500–≥ –∫—É—Ä–∏—Ü—ã", "200–≥ –ª–∞–ø—à–∏", "2 –º–æ—Ä–∫–æ–≤–∏", "1 –ª—É–∫–æ–≤–∏—Ü–∞", "–ó–µ–ª–µ–Ω—å"],
                steps: ["–û—Ç–≤–∞—Ä–∏—Ç–µ –∫—É—Ä–∏—Ü—É –≤ –ø–æ–¥—Å–æ–ª–µ–Ω–Ω–æ–π –≤–æ–¥–µ 20 –º–∏–Ω—É—Ç", "–ù–∞—Ä–µ–∂—å—Ç–µ –º–æ—Ä–∫–æ–≤—å –∏ –ª—É–∫ –∫—É–±–∏–∫–∞–º–∏", "–î–æ—Å—Ç–∞–Ω—å—Ç–µ –∫—É—Ä–∏—Ü—É, –Ω–∞—Ä–µ–∂—å—Ç–µ", "–î–æ–±–∞–≤—å—Ç–µ –æ–≤–æ—â–∏ –≤ –±—É–ª—å–æ–Ω", "–ß–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç –¥–æ–±–∞–≤—å—Ç–µ –ª–∞–ø—à—É", "–í–∞—Ä–∏—Ç–µ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, –¥–æ–±–∞–≤—å—Ç–µ –∫—É—Ä–∏—Ü—É –∏ –∑–µ–ª–µ–Ω—å"],
                isFavorite: false, cooked: false
            },
            {
                id: 6, name: "–°–º—É–∑–∏ –±–æ—É–ª", description: "–ü–æ–ª–µ–∑–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫ —Å —è–≥–æ–¥–∞–º–∏ –∏ —Ç–æ–ø–ø–∏–Ω–≥–∞–º–∏",
                image: "ü´ê", time: 10, calories: 290, difficulty: "easy", category: "breakfast", kitchen: "american",
                protein: 10, fats: 8, carbs: 45, rating: 4.6, reviews: 234, cookCount: 1870,
                tags: ["—Å–º—É–∑–∏", "—Ñ—Ä—É–∫—Ç—ã", "—Å—É–ø–µ—Ä—Ñ—É–¥", "–ø–ø"],
                ingredients: ["1 –±–∞–Ω–∞–Ω", "200–≥ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö —è–≥–æ–¥", "100–º–ª –º–∏–Ω–¥–∞–ª—å–Ω–æ–≥–æ –º–æ–ª–æ–∫–∞", "2 —Å—Ç.–ª. –æ–≤—Å—è–Ω–∫–∏", "–ú—é—Å–ª–∏ –∏ —Å–µ–º–µ–Ω–∞ –¥–ª—è —Ç–æ–ø–ø–∏–Ω–≥–∞"],
                steps: ["–ó–∞–º–æ—Ä–æ–∑—å—Ç–µ –±–∞–Ω–∞–Ω –∑–∞—Ä–∞–Ω–µ–µ", "–°–º–µ—à–∞–π—Ç–µ –±–∞–Ω–∞–Ω, —è–≥–æ–¥—ã –∏ –º–æ–ª–æ–∫–æ –≤ –±–ª–µ–Ω–¥–µ—Ä–µ", "–î–æ–±–∞–≤—å—Ç–µ –æ–≤—Å—è–Ω–∫—É –∏ –≤–∑–±–µ–π—Ç–µ –¥–æ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç–∏", "–í—ã–ª–µ–π—Ç–µ –≤ –º–∏—Å–∫—É", "–£–∫—Ä–∞—Å—å—Ç–µ –º—é—Å–ª–∏, —Å–µ–º–µ–Ω–∞–º–∏ –∏ —Å–≤–µ–∂–∏–º–∏ —è–≥–æ–¥–∞–º–∏"],
                isFavorite: false, cooked: false
            },
            {
                id: 7, name: "–õ–æ—Å–æ—Å—å –Ω–∞ –≥—Ä–∏–ª–µ", description: "–ü–æ–ª–µ–∑–Ω–∞—è —Ä—ã–±–∞ —Å –æ–≤–æ—â–∞–º–∏",
                image: "üêü", time: 25, calories: 380, difficulty: "medium", category: "dinner", kitchen: "mediterranean",
                protein: 35, fats: 22, carbs: 8, rating: 4.9, reviews: 178, cookCount: 1230,
                tags: ["—Ä—ã–±–∞", "–∑–¥–æ—Ä–æ–≤—ã–π", "–≥—Ä–∏–ª—å", "–ø–ø–æ"],
                ingredients: ["400–≥ —Ñ–∏–ª–µ –ª–æ—Å–æ—Å—è", "1 –ª–∏–º–æ–Ω", "–°–ø–µ—Ü–∏–∏ –¥–ª—è —Ä—ã–±—ã", "–û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ", "–°–≤–µ–∂–∏–π —É–∫—Ä–æ–ø"],
                steps: ["–ó–∞–º–∞—Ä–∏–Ω—É–π—Ç–µ –ª–æ—Å–æ—Å—è —Å –ª–∏–º–æ–Ω–æ–º –∏ —Å–ø–µ—Ü–∏—è–º–∏ –Ω–∞ 15 –º–∏–Ω—É—Ç", "–†–∞–∑–æ–≥—Ä–µ–π—Ç–µ –≥—Ä–∏–ª—å –¥–æ —Å—Ä–µ–¥–Ω–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã", "–°–º–∞–∂—å—Ç–µ —Ä–µ—à–µ—Ç–∫—É –º–∞—Å–ª–æ–º", "–ñ–∞—Ä—å—Ç–µ –ª–æ—Å–æ—Å—è 4-5 –º–∏–Ω—É—Ç —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã", "–ü–æ–¥–∞–≤–∞–π—Ç–µ —Å –¥–æ–ª—å–∫–∞–º–∏ –ª–∏–º–æ–Ω–∞ –∏ —É–∫—Ä–æ–ø–æ–º"],
                isFavorite: false, cooked: false
            },
            {
                id: 8, name: "–û–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É", description: "–õ–µ–≥–∫–æ–µ –∏ —Å—ã—Ç–Ω–æ–µ –±–ª—é–¥–æ –∏–∑ —Å–µ–∑–æ–Ω–Ω—ã—Ö –æ–≤–æ—â–µ–π",
                image: "ü•ï", time: 35, calories: 220, difficulty: "easy", category: "healthy", kitchen: "mediterranean",
                protein: 6, fats: 8, carbs: 32, rating: 4.5, reviews: 156, cookCount: 2340,
                tags: ["–æ–≤–æ—â–∏", "–≤–µ–≥–∞–Ω", "–¥–∏–µ—Ç–∏—á–µ—Å–∫–æ–µ", "–ø–æ—Å—Ç"],
                ingredients: ["2 –º–æ—Ä–∫–æ–≤–∏", "1 –∫–∞–±–∞—á–æ–∫", "1 –±–∞–∫–ª–∞–∂–∞–Ω", "1 –ª—É–∫–æ–≤–∏—Ü–∞", "3 –ø–æ–º–∏–¥–æ—Ä–∞", "–°–ø–µ—Ü–∏–∏"],
                steps: ["–ù–∞—Ä–µ–∂—å—Ç–µ –≤—Å–µ –æ–≤–æ—â–∏ –∫—É–±–∏–∫–∞–º–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞", "–û–±–∂–∞—Ä—å—Ç–µ –ª—É–∫ –Ω–∞ –æ–ª–∏–≤–∫–æ–≤–æ–º –º–∞—Å–ª–µ", "–î–æ–±–∞–≤—å—Ç–µ –º–æ—Ä–∫–æ–≤—å –∏ –±–∞–∫–ª–∞–∂–∞–Ω", "–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –¥–æ–±–∞–≤—å—Ç–µ –∫–∞–±–∞—á–æ–∫ –∏ –ø–æ–º–∏–¥–æ—Ä—ã", "–¢—É—à–∏—Ç–µ –ø–æ–¥ –∫—Ä—ã—à–∫–æ–π 20 –º–∏–Ω—É—Ç", "–ü—Ä–∏–ø—Ä–∞–≤—å—Ç–µ –∏ –ø–æ–¥–∞–≤–∞–π—Ç–µ"],
                isFavorite: false, cooked: false
            },
            {
                id: 9, name: "–†–∞–º–µ–Ω", description: "–Ø–ø–æ–Ω—Å–∫–∏–π —Å—É–ø —Å –ª–∞–ø—à–æ–π –∏ –±—É–ª—å–æ–Ω–æ–º",
                image: "üçú", time: 60, calories: 420, difficulty: "hard", category: "dinner", kitchen: "asian",
                protein: 28, fats: 18, carbs: 48, rating: 4.9, reviews: 312, cookCount: 870,
                tags: ["—è–ø–æ–Ω—Å–∫–∏–π", "—Å—É–ø", "–ª–∞–ø—à–∞", "–∞–∑–∏–∞—Ç—Å–∫–∞—è"],
                ingredients: ["500–º–ª –∫—É—Ä–∏–Ω–æ–≥–æ –±—É–ª—å–æ–Ω–∞", "200–≥ –ª–∞–ø—à–∏ —Ä–∞–º–µ–Ω", "200–≥ —Å–≤–∏–Ω–∏–Ω—ã", "2 —è–π—Ü–∞", "–ó–µ–ª–µ–Ω—ã–π –ª—É–∫", "–ù–æ—Ä–∏"],
                steps: ["–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ –Ω–∞–≤–∞—Ä–∏—Å—Ç—ã–π –±—É–ª—å–æ–Ω", "–û—Ç–≤–∞—Ä–∏—Ç–µ –ª–∞–ø—à—É –æ—Ç–¥–µ–ª—å–Ω–æ", "–ù–∞—Ä–µ–∂—å—Ç–µ —Å–≤–∏–Ω–∏–Ω—É —Ç–æ–Ω–∫–∏–º–∏ –ª–æ–º—Ç–∏–∫–∞–º–∏", "–°–≤–∞—Ä–∏—Ç–µ —è–π—Ü–∞ –≤–∫—Ä—É—Ç—É—é", "–°–æ–±–µ—Ä–∏—Ç–µ —Ä–∞–º–µ–Ω –≤ –º–∏—Å–∫–µ: –±—É–ª—å–æ–Ω, –ª–∞–ø—à–∞, –º—è—Å–æ, —è–π—Ü–æ", "–£–∫—Ä–∞—Å—å—Ç–µ –ª—É–∫–æ–º –∏ –Ω–æ—Ä–∏"],
                isFavorite: false, cooked: false
            },
            {
                id: 10, name: "–¢–∏—Ä–∞–º–∏—Å—É", description: "–ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π –¥–µ—Å–µ—Ä—Ç —Å –º–∞—Å–∫–∞—Ä–ø–æ–Ω–µ",
                image: "üç∞", time: 40, calories: 450, difficulty: "medium", category: "desserts", kitchen: "italian",
                protein: 10, fats: 28, carbs: 42, rating: 4.9, reviews: 423, cookCount: 1120,
                tags: ["–∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–π", "–¥–µ—Å–µ—Ä—Ç", "–∫–æ—Ñ–µ", "–∫–ª–∞—Å—Å–∏–∫–∞"],
                ingredients: ["500–≥ –º–∞—Å–∫–∞—Ä–ø–æ–Ω–µ", "200–≥ —Å–∞–≤–æ—è—Ä–¥–∏", "4 —è–π—Ü–∞", "150–≥ —Å–∞—Ö–∞—Ä–∞", "–≠—Å–ø—Ä–µ—Å—Å–æ", "–ö–∞–∫–∞–æ"],
                steps: ["–û—Ç–¥–µ–ª–∏—Ç–µ –±–µ–ª–∫–∏ –æ—Ç –∂–µ–ª—Ç–∫–æ–≤", "–í–∑–±–µ–π—Ç–µ –∂–µ–ª—Ç–∫–∏ —Å —Å–∞—Ö–∞—Ä–æ–º –¥–æ –ø—ã—à–Ω–æ—Å—Ç–∏", "–î–æ–±–∞–≤—å—Ç–µ –º–∞—Å–∫–∞—Ä–ø–æ–Ω–µ", "–í–∑–±–µ–π—Ç–µ –±–µ–ª–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –º–∏—Å–∫–µ", "–ê–∫–∫—É—Ä–∞—Ç–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ", "–°–º–æ—á–∏—Ç–µ –ø–µ—á–µ–Ω—å–µ –≤ –∫–æ—Ñ–µ, –≤—ã–ª–æ–∂–∏—Ç–µ —Å–ª–æ—è–º–∏ —Å –∫—Ä–µ–º–æ–º", "–û—Ö–ª–∞–¥–∏—Ç–µ 4 —á–∞—Å–∞, –ø–æ—Å—ã–ø—å—Ç–µ –∫–∞–∫–∞–æ"],
                isFavorite: false, cooked: false
            },
            {
                id: 11, name: "–§–∞–ª–∞—Ñ–µ–ª—å", description: "–ë–ª–∏–∂–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –∫–æ—Ç–ª–µ—Ç–∫–∏ –∏–∑ –Ω—É—Ç–∞",
                image: "üßÜ", time: 35, calories: 280, difficulty: "medium", category: "lunch", kitchen: "mediterranean",
                protein: 14, fats: 12, carbs: 32, rating: 4.6, reviews: 198, cookCount: 1560,
                tags: ["–≤–µ–≥–∞–Ω", "–±–ª–∏–∂–Ω–∏–π –≤–æ—Å—Ç–æ–∫", "–∂–∞—Ä–µ–Ω—ã–π", "–Ω—É—Ç"],
                ingredients: ["400–≥ –Ω—É—Ç–∞", "1 –ª—É–∫–æ–≤–∏—Ü–∞", "3 –∑—É–±—á–∏–∫–∞ —á–µ—Å–Ω–æ–∫–∞", "–ü–µ—Ç—Ä—É—à–∫–∞", "–°–ø–µ—Ü–∏–∏", "–ú–∞—Å–ª–æ –¥–ª—è –∂–∞—Ä–∫–∏"],
                steps: ["–ó–∞–º–æ—á–∏—Ç–µ –Ω—É—Ç –Ω–∞ –Ω–æ—á—å", "–ò–∑–º–µ–ª—å—á–∏—Ç–µ –Ω—É—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ", "–î–æ–±–∞–≤—å—Ç–µ –ª—É–∫, —á–µ—Å–Ω–æ–∫, –∑–µ–ª–µ–Ω—å", "–ü—Ä–∏–ø—Ä–∞–≤—å—Ç–µ –∏ —Å—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ –∫–æ—Ç–ª–µ—Ç–∫–∏", "–û–±–∂–∞—Ä—å—Ç–µ –≤–æ —Ñ—Ä–∏—Ç—é—Ä–µ –¥–æ –∑–æ–ª–æ—Ç–∏—Å—Ç–æ–π –∫–æ—Ä–æ—á–∫–∏", "–ü–æ–¥–∞–≤–∞–π—Ç–µ —Å –ª–∞–≤–∞—à–µ–º –∏ —Å–æ—É—Å–æ–º"],
                isFavorite: false, cooked: false
            },
            {
                id: 12, name: "–ì—Ä–µ—á–µ—Å–∫–∏–π —Å–∞–ª–∞—Ç", description: "–°–≤–µ–∂–∏–π —Å—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä—Å–∫–∏–π —Å–∞–ª–∞—Ç",
                image: "ü•í", time: 15, calories: 250, difficulty: "easy", category: "lunch", kitchen: "mediterranean",
                protein: 12, fats: 18, carbs: 12, rating: 4.7, reviews: 289, cookCount: 3420,
                tags: ["—Å–∞–ª–∞—Ç", "–≥—Ä–µ—Ü–∏—è", "—Å–≤–µ–∂–∏–π", "–ª–µ—Ç–æ"],
                ingredients: ["2 –ø–æ–º–∏–¥–æ—Ä–∞", "1 –æ–≥—É—Ä–µ—Ü", "1 –∫—Ä–∞—Å–Ω—ã–π –ª—É–∫", "200–≥ —Ñ–µ—Ç—ã", "–û–ª–∏–≤–∫–∏", "–û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ", "–û—Ä–µ–≥–∞–Ω–æ"],
                steps: ["–ù–∞—Ä–µ–∂—å—Ç–µ –ø–æ–º–∏–¥–æ—Ä—ã –∫—Ä—É–ø–Ω—ã–º–∏ –∫—É—Å–æ—á–∫–∞–º–∏", "–ù–∞—Ä–µ–∂—å—Ç–µ –æ–≥—É—Ä–µ—Ü –ø–æ–ª—É–∫–æ–ª—å—Ü–∞–º–∏", "–¢–æ–Ω–∫–æ –Ω–∞—Ä–µ–∂—å—Ç–µ –ª—É–∫", "–°–º–µ—à–∞–π—Ç–µ –æ–≤–æ—â–∏", "–î–æ–±–∞–≤—å—Ç–µ —Ñ–µ—Ç—É –∏ –æ–ª–∏–≤–∫–∏", "–ü–æ–ª–µ–π—Ç–µ –º–∞—Å–ª–æ–º, –ø–æ—Å—ã–ø—å—Ç–µ –æ—Ä–µ–≥–∞–Ω–æ"],
                isFavorite: false, cooked: false
            },
            {
                id: 13, name: "–ü–∞–Ω–∫–µ–π–∫–∏", description: "–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ –æ–ª–∞–¥—É—à–∫–∏ —Å –∫–ª–µ–Ω–æ–≤—ã–º —Å–∏—Ä–æ–ø–æ–º",
                image: "ü•û", time: 25, calories: 380, difficulty: "easy", category: "breakfast", kitchen: "american",
                protein: 10, fats: 14, carbs: 52, rating: 4.8, reviews: 534, cookCount: 4560,
                tags: ["–∑–∞–≤—Ç—Ä–∞–∫", "–∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ", "—Å–ª–∞–¥–∫–∏–µ", "–¥–µ—Ç–∏"],
                ingredients: ["200–≥ –º—É–∫–∏", "2 —è–π—Ü–∞", "300–º–ª –º–æ–ª–æ–∫–∞", "2 —Å—Ç.–ª. —Å–∞—Ö–∞—Ä–∞", "–†–∞–∑—Ä—ã—Ö–ª–∏—Ç–µ–ª—å", "–°–ª–∏–≤–æ—á–Ω–æ–µ –º–∞—Å–ª–æ", "–°–∏—Ä–æ–ø"],
                steps: ["–°–º–µ—à–∞–π—Ç–µ —Å—É—Ö–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã", "–î–æ–±–∞–≤—å—Ç–µ —è–π—Ü–∞ –∏ –º–æ–ª–æ–∫–æ", "–í–∑–±–µ–π—Ç–µ –¥–æ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç–∏", "–í—ã–ø–µ–∫–∞–π—Ç–µ –Ω–∞ —Å–∫–æ–≤–æ—Ä–æ–¥–µ —Å –¥–≤—É—Ö —Å—Ç–æ—Ä–æ–Ω", "–ü–æ–¥–∞–≤–∞–π—Ç–µ —Å –º–∞—Å–ª–æ–º –∏ —Å–∏—Ä–æ–ø–æ–º"],
                isFavorite: false, cooked: false
            },
            {
                id: 14, name: "–¢acos", description: "–ú–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∏–µ –ª–µ–ø—ë—à–∫–∏ —Å –Ω–∞—á–∏–Ω–∫–æ–π",
                image: "üåÆ", time: 30, calories: 350, difficulty: "medium", category: "dinner", kitchen: "mexican",
                protein: 22, fats: 16, carbs: 36, rating: 4.8, reviews: 367, cookCount: 2340,
                tags: ["–º–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∏–π", "–º—è—Å–æ", "–æ—Å—Ç—Ä—ã–π", "–≤–µ—á–µ—Ä–∏–Ω–∫–∞"],
                ingredients: ["8 –ª–µ–ø–µ—à–µ–∫", "300–≥ —Ñ–∞—Ä—à–∞", "1 –ª—É–∫–æ–≤–∏—Ü–∞", "2 –ø–æ–º–∏–¥–æ—Ä–∞", "–°—ã—Ä", "–°–∞–ª–∞—Ç", "–°–æ—É—Å —Å–∞–ª—å—Å–∞"],
                steps: ["–û–±–∂–∞—Ä—å—Ç–µ —Ñ–∞—Ä—à —Å –ª—É–∫–æ–º", "–ü—Ä–∏–ø—Ä–∞–≤—å—Ç–µ –ø–æ-–º–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∏", "–ü–æ–¥–æ–≥—Ä–µ–π—Ç–µ –ª–µ–ø–µ—à–∫–∏", "–ù–∞—Ä–µ–∂—å—Ç–µ –æ–≤–æ—â–∏", "–°–æ–±–µ—Ä–∏—Ç–µ —Ç–∞–∫–æ—Å: –º—è—Å–æ, –æ–≤–æ—â–∏, —Å—ã—Ä, —Å–æ—É—Å"],
                isFavorite: false, cooked: false
            },
            {
                id: 15, name: "–ö–∏–º—á–∏", description: "–ö–æ—Ä–µ–π—Å–∫–∞—è –æ—Å—Ç—Ä–∞—è –∑–∞–∫—É—Å–∫–∞",
                image: "ü•¨", time: 120, calories: 45, difficulty: "hard", category: "healthy", kitchen: "asian",
                protein: 3, fats: 0, carbs: 8, rating: 4.5, reviews: 145, cookCount: 890,
                tags: ["–∫–æ—Ä–µ–π—Å–∫–∏–π", "—Ñ–µ—Ä–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π", "–∑–¥–æ—Ä–æ–≤—ã–π", "–æ—Å—Ç—Ä–∞—è"],
                ingredients: ["1 –∫–æ—á–∞–Ω –ø–µ–∫–∏–Ω—Å–∫–æ–π –∫–∞–ø—É—Å—Ç—ã", "4 —Å—Ç.–ª. –∫–æ—Ä–µ–π—Å–∫–æ–π –ø–∞—Å—Ç—ã –≥–æ—á—É–¥–∂–∞–Ω", "–°–æ–ª—å", "–ß–µ—Å–Ω–æ–∫", "–ò–º–±–∏—Ä—å", "–†–µ–¥–∏—Å"],
                steps: ["–ù–∞—Ä–µ–∂—å—Ç–µ –∫–∞–ø—É—Å—Ç—É –∏ –ø–æ—Å–æ–ª–∏—Ç–µ", "–û—Å—Ç–∞–≤—å—Ç–µ –Ω–∞ 4 —á–∞—Å–∞", "–°–º–µ—à–∞–π—Ç–µ –ø–∞—Å—Ç—É —Å —á–µ—Å–Ω–æ–∫–æ–º –∏ –∏–º–±–∏—Ä—ë–º", "–ü—Ä–æ–º–æ–π—Ç–µ –∫–∞–ø—É—Å—Ç—É", "–û–±–∏–ª—å–Ω–æ —Å–º–∞–∂—å—Ç–µ —Å–º–µ—Å—å—é", "–§–µ—Ä–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏ –∫–æ–º–Ω–∞—Ç–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ 2 –¥–Ω—è"],
                isFavorite: false, cooked: false
            }
        ];

        let communityPosts = [
            {
                id: 1, user: "–ú–∞—à–∞ –ö—É–ª–∏–Ω–∞—Ä–∏—è", avatar: "üë©‚Äçüç≥", time: "2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥",
                content: "–°–µ–≥–æ–¥–Ω—è –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞ –¥–æ–º–∞—à–Ω—é—é –ø–∞—Å—Ç—É! ü•Ç –ü–æ–ª—É—á–∏–ª–æ—Å—å –Ω–µ —Ö—É–∂–µ, —á–µ–º –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ. –ö—Ç–æ —Ö–æ—á–µ—Ç —Ä–µ—Ü–µ–ø—Ç?",
                image: "üçù", likes: 234, comments: 45, isLiked: false,
                recipes: []
            },
            {
                id: 2, user: "–®–µ—Ñ –ò–≤–∞–Ω–æ–≤", avatar: "üë®‚Äçüç≥", time: "4 —á–∞—Å–∞ –Ω–∞–∑–∞–¥",
                content: "–°–µ–∫—Ä–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–µ–π–∫–∞: –¥–∞–π—Ç–µ –º—è—Å—É –æ—Ç–¥–æ—Ö–Ω—É—Ç—å 10 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –∂–∞—Ä–∫–∏. –≠—Ç–æ –º–µ–Ω—è–µ—Ç –≤—Å—ë!",
                image: null, likes: 567, comments: 89, isLiked: true,
                recipes: [7]
            },
            {
                id: 3, user: "Healthy Anna", avatar: "üí™", time: "5 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥",
                content: "–ú–æ–π –ª—é–±–∏–º—ã–π –ü–ü –∑–∞–≤—Ç—Ä–∞–∫ –Ω–∞ –Ω–µ–¥–µ–ª—é: –æ–≤—Å—è–Ω–∫–∞ —Å —è–≥–æ–¥–∞–º–∏ –∏ –æ—Ä–µ—Ö–∞–º–∏. 350 –∫–∫–∞–ª, —Å—ã—Ç–Ω–æ –¥–æ –æ–±–µ–¥–∞!",
                image: "ü•£", likes: 189, comments: 34, isLiked: false,
                recipes: [6]
            }
        ];

        let userProfile = {
            name: "–ì–æ—Å—Ç—å",
            goal: "maintain",
            diets: [],
            allergies: [],
            preferredKitchens: [],
            dislikedIngredients: [],
            fridgeProducts: [],
            searchPersonalizationEnabled: true,
            dailyNutrition: { calories: 1200, protein: 50, fats: 40, carbs: 150, fiber: 25 },
            targetCalories: 2000,
            waterGlasses: 3,
            targetWater: 8,
            weightHistory: [78, 77.5, 77.8, 77.2, 77.0, 76.8, 76.5],
            savedRecipes: [],
            myRecipes: [],
            cookedRecipes: [],
            following: [],
            xp: 150,
            level: 1,
            streak: 0,
            achievements: []
        };

        let shoppingList = [
            { id: 1, name: "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞", amount: "500–≥", category: "meat", bought: false, estimatedPrice: 350 },
            { id: 2, name: "–°–ø–∞—Ä–∂–∞", amount: "200–≥", category: "vegetables", bought: true, estimatedPrice: 280 },
            { id: 3, name: "–ü–æ–º–∏–¥–æ—Ä—ã", amount: "4 —à—Ç", category: "vegetables", bought: false, estimatedPrice: 120 },
            { id: 4, name: "–ú–æ—Ü–∞—Ä–µ–ª–ª–∞", amount: "200–≥", category: "dairy", bought: false, estimatedPrice: 250 },
            { id: 5, name: "–ë–∞–∑–∏–ª–∏–∫", amount: "1 –ø—É—á–æ–∫", category: "vegetables", bought: true, estimatedPrice: 80 },
            { id: 6, name: "–°–ø–∞–≥–µ—Ç—Ç–∏", amount: "500–≥", category: "grains", bought: false, estimatedPrice: 90 },
            { id: 7, name: "–ü–∞—Ä–º–µ–∑–∞–Ω", amount: "100–≥", category: "dairy", bought: false, estimatedPrice: 450 },
            { id: 8, name: "–û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ", amount: "1–ª", category: "spices", bought: false, estimatedPrice: 650 }
        ];

        let weeklyPlan = {
            monday: { breakfast: null, lunch: null, dinner: null },
            tuesday: { breakfast: null, lunch: null, dinner: null },
            wednesday: { breakfast: null, lunch: null, dinner: null },
            thursday: { breakfast: null, lunch: null, dinner: null },
            friday: { breakfast: null, lunch: null, dinner: null },
            saturday: { breakfast: null, lunch: null, dinner: null },
            sunday: { breakfast: null, lunch: null, dinner: null }
        };

        let currentPage = 'home';
        let currentRecipe = null;
        let voiceMode = false;
        let filters = { vegan: false, vegetarian: false, keto: false, glutenFree: false, paleo: false, maxTime: null, maxCalories: null, difficulty: null, kitchen: null };
        let selectedMealType = 'breakfast';
        let currentCookingStep = 0;
        let cookingTimer = null;
        let timerInterval = null;
        let recipeViewMode = 'grid';
        let recipeTags = [];
        let searchPreferences = { useFridge: false };

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            loadFromStorage();
            renderRecommendations();
            renderPopularRecipes();
            renderAllRecipes();
            renderShoppingList();
            updateProfileStats();
            renderWeekDays();
            renderDayMeals();
            renderCommunityFeed();
            updateNutritionProgress();
            updateHomeStats();
            checkInstallPrompt();
            addInitialChatMessage();
        });

        // ============================================
        // STORAGE
        // ============================================
        function loadFromStorage() {
            const saved = localStorage.getItem('chefHelperData');
            if (saved) {
                const data = JSON.parse(saved);
                userProfile = { ...userProfile, ...data.userProfile };
                shoppingList = data.shoppingList || shoppingList;
                weeklyPlan = data.weeklyPlan || weeklyPlan;
                recipes = recipes.map(r => ({
                    ...r,
                    isFavorite: data.favorites?.includes(r.id) || false,
                    cooked: data.cookedRecipes?.includes(r.id) || false
                }));
                userProfile.myRecipes = data.myRecipes || [];
            }
        }

        function saveToStorage() {
            const data = {
                userProfile,
                shoppingList,
                weeklyPlan,
                favorites: recipes.filter(r => r.isFavorite).map(r => r.id),
                cookedRecipes: recipes.filter(r => r.cooked).map(r => r.id),
                myRecipes: userProfile.myRecipes
            };
            localStorage.setItem('chefHelperData', JSON.stringify(data));
        }

        // ============================================
        // NAVIGATION
        // ============================================
        function navigateTo(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${page}`).classList.add('active');
            
            document.querySelectorAll('.bottom-nav-item').forEach(item => {
                item.classList.remove('tab-active');
                item.classList.add('tab-inactive');
            });
            event.currentTarget.classList.remove('tab-inactive');
            event.currentTarget.classList.add('tab-active');
            
            currentPage = page;
            
            // Refresh content on page switch
            if (page === 'planner') renderWeekDays();
            if (page === 'shopping') updateShoppingStats();
            if (page === 'community') renderCommunityFeed();
        }

        // ============================================
        // SEARCH & FILTERS
        // ============================================
        function handleSearch(event) {
            const query = event.target.value.toLowerCase();
            if (query.length > 2) {
                filterRecipes(query);
            } else if (query.length === 0) {
                document.getElementById('searchSuggestions').classList.add('hidden');
                renderRecommendations();
                renderPopularRecipes();
            }
        }

        function showSearchSuggestions() {
            document.getElementById('searchSuggestions').classList.remove('hidden');
        }

        function quickSearch(query) {
            document.getElementById('searchInput').value = query;
            document.getElementById('searchSuggestions').classList.add('hidden');
            filterRecipes(query);
        }

        function toggleFilters() {
            const panel = document.getElementById('filtersPanel');
            panel.classList.toggle('hidden');
        }

        function toggleFilter(filter) {
            filters[filter] = !filters[filter];
            const chip = document.querySelector(`[data-filter="${filter}"]`);
            chip.classList.toggle('selected');
        }

        function setTimeFilter(minutes) {
            filters.maxTime = minutes;
            showToast(`–§–∏–ª—å—Ç—Ä: –¥–æ ${minutes} –º–∏–Ω—É—Ç`);
        }

        function setCalorieFilter(calories) {
            filters.maxCalories = calories;
            showToast(`–§–∏–ª—å—Ç—Ä: –¥–æ ${calories} –∫–∫–∞–ª`);
        }

        function setDifficultyFilter(difficulty) {
            filters.difficulty = difficulty;
            showToast(`–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${difficulty}`);
        }

        function toggleKitchen(kitchen) {
            filters.kitchen = filters.kitchen === kitchen ? null : kitchen;
            showToast(`–ö—É—Ö–Ω—è: ${kitchen || '–≤—Å–µ'}`);
        }

        function resetFilters() {
            filters = { vegan: false, vegetarian: false, keto: false, glutenFree: false, paleo: false, maxTime: null, maxCalories: null, difficulty: null, kitchen: null };
            document.querySelectorAll('.filter-chip').forEach(chip => chip.classList.remove('selected'));
            showToast('–§–∏–ª—å—Ç—Ä—ã —Å–±—Ä–æ—à–µ–Ω—ã');
        }

        function applyFilters() {
            filterRecipes(document.getElementById('searchInput').value);
            document.getElementById('filtersPanel').classList.add('hidden');
            showToast('–§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã');
        }

        function filterByCategory(category) {
            let filtered = recipes;
            if (category !== 'all') {
                filtered = recipes.filter(r => r.category === category || r.tags.includes(category));
            }
            renderRecipeGrid(filtered, 'popularRecipes', true);
            showToast(`–ü–æ–∫–∞–∑–∞–Ω–æ: ${category === 'all' ? '–≤—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã' : category}`);
        }

        function filterByCollection(collection) {
            const collections = {
                'quick-dinner': { name: '–ë—ã—Å—Ç—Ä—ã–π —É–∂–∏–Ω', filter: r => r.time <= 30 },
                'healthy': { name: '–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ', filter: r => r.category === 'healthy' || r.tags.includes('–ø–ø') || r.tags.includes('–∑–¥–æ—Ä–æ–≤—ã–π') },
                'breakfast': { name: '–ó–∞–≤—Ç—Ä–∞–∫–∏', filter: r => r.category === 'breakfast' },
                'family': { name: '–°–µ–º–µ–π–Ω—ã–µ', filter: r => r.tags.includes('—Å–µ–º–µ–π–Ω—ã–π') || !r.tags.includes('—Å–ª–æ–∂–Ω—ã–π') }
            };
            const coll = collections[collection];
            if (coll) {
                const filtered = recipes.filter(coll.filter);
                renderRecipeGrid(filtered, 'popularRecipes', true);
                showToast(`–ü–æ–¥–±–æ—Ä–∫–∞: ${coll.name} (${filtered.length} —Ä–µ—Ü–µ–ø—Ç–æ–≤)`);
            }
        }

        function filterRecipes(query) {
            let filtered = recipes;
            const q = (query || '').toLowerCase();
            
            // –ë–∞–∑–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
            if (q) {
                filtered = filtered.filter(r => 
                    r.name.toLowerCase().includes(q) ||
                    r.description.toLowerCase().includes(q) ||
                    r.ingredients.some(i => i.toLowerCase().includes(q)) ||
                    r.tags.some(t => t.toLowerCase().includes(q)) ||
                    r.category.toLowerCase().includes(q)
                );
            }

            // –§–∏–ª—å—Ç—Ä—ã –∏–∑ –ø–∞–Ω–µ–ª–∏
            if (filters.vegan) filtered = filtered.filter(r => r.tags.some(t => t.toLowerCase().includes('–≤–µ–≥–∞–Ω')));
            if (filters.vegetarian) filtered = filtered.filter(r => r.tags.some(t => t.toLowerCase().includes('–≤–µ–≥–µ—Ç–∞—Ä')) || !r.ingredients.some(i => /–º—è—Å–æ|–∫—É—Ä–∏—Ü|–≥–æ–≤—è–¥–∏–Ω|—Å–≤–∏–Ω–∏–Ω|—Ä—ã–±/gi.test(i)));
            if (filters.keto) filtered = filtered.filter(r => r.carbs < 20);
            if (filters.glutenFree) filtered = filtered.filter(r => !r.ingredients.some(i => /–ø—à–µ–Ω–∏—Ü|–º—É–∫–∞|–º–∞–∫–∞—Ä–æ–Ω|–ª–∞–ø—à|—Ö–ª–µ–±/gi.test(i)));
            if (filters.maxTime) filtered = filtered.filter(r => r.time <= parseInt(filters.maxTime));
            if (filters.maxCalories) filtered = filtered.filter(r => r.calories <= parseInt(filters.maxCalories));
            if (filters.difficulty) filtered = filtered.filter(r => r.difficulty === filters.difficulty);
            if (filters.kitchen) filtered = filtered.filter(r => r.kitchen === filters.kitchen);

            // –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
            if (userProfile.searchPersonalizationEnabled) {
                // –£—á–∏—Ç—ã–≤–∞–µ–º –¥–∏–µ—Ç—ã
                if (userProfile.diets.includes('vegan')) {
                    filtered = filtered.filter(r => r.tags.some(t => t.toLowerCase().includes('–≤–µ–≥–∞–Ω')));
                }
                if (userProfile.diets.includes('vegetarian')) {
                    filtered = filtered.filter(r => !r.ingredients.some(i => /–º—è—Å–æ|–∫—É—Ä–∏—Ü|–≥–æ–≤—è–¥–∏–Ω|—Å–≤–∏–Ω–∏–Ω|—Ä—ã–±/gi.test(i)));
                }
                if (userProfile.diets.includes('glutenFree')) {
                    filtered = filtered.filter(r => !r.ingredients.some(i => /–ø—à–µ–Ω–∏—Ü|–º—É–∫–∞|–º–∞–∫–∞—Ä–æ–Ω|–ª–∞–ø—à|—Ö–ª–µ–±/gi.test(i)));
                }

                // –£—á–∏—Ç—ã–≤–∞–µ–º –∞–ª–ª–µ—Ä–≥–∏–∏ –∏ –Ω–µ–ª—é–±–∏–º—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
                const banned = [...userProfile.allergies, ...userProfile.dislikedIngredients].map(x => x.toLowerCase());
                if (banned.length) {
                    filtered = filtered.filter(r => !r.ingredients.some(i => banned.some(b => i.toLowerCase().includes(b))));
                }

                // –£—á–∏—Ç—ã–≤–∞–µ–º –ª—é–±–∏–º—ã–µ –∫—É—Ö–Ω–∏ ‚Äî –ø–æ–≤—ã—à–∞–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å
                if (userProfile.preferredKitchens.length) {
                    filtered = filtered
                        .map(r => ({
                            recipe: r,
                            score: (userProfile.preferredKitchens.includes(r.kitchen) ? 2 : 1) + (r.isFavorite ? 1.5 : 0) + (r.cooked ? 1 : 0)
                        }))
                        .sort((a, b) => b.score - a.score)
                        .map(x => x.recipe);
                }

                // –†–µ–∂–∏–º "–∏–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞" ‚Äî –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ä–µ—Ü–µ–ø—Ç—ã, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –µ—Å—Ç—å
                if (searchPreferences.useFridge && userProfile.fridgeProducts.length) {
                    const fridge = userProfile.fridgeProducts.map(p => p.toLowerCase());
                    filtered = filtered.filter(r => {
                        const total = r.ingredients.length || 1;
                        const match = r.ingredients.filter(i => fridge.some(f => i.toLowerCase().includes(f))).length;
                        return match / total >= 0.4; // –º–∏–Ω–∏–º—É–º 40% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
                    });
                }
            }

            renderRecipeGrid(filtered, 'popularRecipes', true);
        }

        function sortRecipes(sortBy) {
            if (sortBy) {
                if (sortBy === 'easy') filterRecipes('–ª–µ–≥–∫–æ');
                else if (sortBy === 'quick') filterRecipes('');
                else if (sortBy === 'healthy') filterRecipes('–ø–ø');
                else if (sortBy === 'vegan') filterRecipes('–≤–µ–≥–∞–Ω');
            }
            const sort = document.getElementById('sortSelect').value;
            let sorted = [...recipes];
            if (sort === 'popular') sorted.sort((a, b) => b.reviews - a.reviews);
            else if (sort === 'new') sorted.sort((a, b) => b.id - a.id);
            else if (sort === 'rating') sorted.sort((a, b) => b.rating - a.rating);
            else if (sort === 'time') sorted.sort((a, b) => a.time - b.time);
            else if (sort === 'calories') sorted.sort((a, b) => a.calories - b.calories);
            renderRecipeGrid(sorted, 'allRecipes');
        }

        function toggleViewMode() {
            const container = document.getElementById('allRecipes');
            recipeViewMode = recipeViewMode === 'grid' ? 'list' : 'grid';
            container.className = recipeViewMode === 'grid' ? 'grid grid-cols-2 gap-3' : 'flex flex-col gap-3';
            renderAllRecipes();
        }

        // ============================================
        // RENDERING
        // ============================================
        function renderRecommendations() {
            const container = document.getElementById('aiRecommendations');
            let recs = recipes.filter(r => !r.cooked);

            // –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞
            recs = recs.map(r => {
                let score = 0;
                if (r.isFavorite) score += 3;
                if (userProfile.preferredKitchens.includes(r.kitchen)) score += 2;
                if (userProfile.diets.includes('vegan') && r.tags.some(t => t.toLowerCase().includes('–≤–µ–≥–∞–Ω'))) score += 2;
                if (userProfile.diets.includes('healthy') && r.category === 'healthy') score += 2;
                if (userProfile.goal === 'lose' && r.calories <= 350) score += 2;
                if (userProfile.goal === 'gain' && r.protein >= 20) score += 2;

                // –ú–∞—Ç—á —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –∏–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞
                if (userProfile.fridgeProducts.length) {
                    const fridge = userProfile.fridgeProducts.map(p => p.toLowerCase());
                    const match = r.ingredients.filter(i => fridge.some(f => i.toLowerCase().includes(f))).length;
                    score += match * 0.5;
                }

                // –ù–∞–∫–∞–∑–∞–Ω–∏–µ –∑–∞ –∞–ª–ª–µ—Ä–≥–µ–Ω—ã / –Ω–µ–ª—é–±–∏–º—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
                const banned = [...userProfile.allergies, ...userProfile.dislikedIngredients].map(x => x.toLowerCase());
                if (banned.length && r.ingredients.some(i => banned.some(b => i.toLowerCase().includes(b)))) {
                    score -= 5;
                }

                return { recipe: r, score };
            })
            .sort((a, b) => b.score - a.score || b.recipe.rating - a.recipe.rating)
            .slice(0, 10)
            .map(x => x.recipe);
            
            container.innerHTML = recs.map(recipe => `
                <div class="recipe-card flex-shrink-0 w-36 bg-white rounded-2xl shadow-sm overflow-hidden" onclick="openRecipe(${recipe.id})">
                    <div class="h-28 relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-emerald-50 to-teal-50"></div>
                        <img src="${getRecipePhoto(recipe.id)}" alt="${recipe.name}" class="w-full h-full object-cover relative z-0">
                        ${recipe.tags.some(t => t.toLowerCase().includes('–≤–µ–≥–∞–Ω')) ? '<span class="absolute top-2 left-2 text-xs bg-green-500 text-white px-2 py-0.5 rounded-full z-10">üå±</span>' : ''}
                    </div>
                    <div class="p-2">
                        <h4 class="font-semibold text-sm truncate">${recipe.name}</h4>
                        <div class="flex items-center gap-1 mt-1 text-xs text-gray-500">
                            <span>‚è±Ô∏è ${recipe.time}–º</span>
                            <span>üî• ${recipe.calories}</span>
                        </div>
                        <div class="flex items-center gap-1 mt-1">
                            <span class="text-xs">‚≠ê ${recipe.rating}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderPopularRecipes() {
            const container = document.getElementById('popularRecipes');
            const popular = [...recipes].sort((a, b) => b.reviews - a.reviews).slice(0, 6);
            renderRecipeGrid(popular, 'popularRecipes');
        }

        function renderAllRecipes() {
            renderRecipeGrid(recipes, 'allRecipes');
        }

        function renderRecipeGrid(recipeList, containerId, isHorizontal = false) {
            const container = document.getElementById(containerId);
            container.innerHTML = recipeList.map(recipe => `
                <div class="recipe-card ${isHorizontal ? 'flex-shrink-0 w-36' : recipeViewMode === 'list' ? 'flex flex-row' : ''} bg-white rounded-2xl shadow-sm overflow-hidden ${recipeViewMode === 'list' ? 'h-28' : ''}" onclick="openRecipe(${recipe.id})">
                    <div class="${isHorizontal ? 'h-28' : recipeViewMode === 'list' ? 'w-28 h-full' : 'h-36'} relative overflow-hidden flex-shrink-0">
                        <div class="absolute inset-0 bg-gradient-to-br from-emerald-50 to-teal-50"></div>
                        <img src="${getRecipePhoto(recipe.id)}" alt="${recipe.name}" class="w-full h-full object-cover relative z-0">
                        ${recipe.difficulty === 'easy' ? '<span class="absolute top-2 right-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full z-10">–õ–µ–≥–∫–æ</span>' : ''}
                    </div>
                    <div class="p-3 flex-1 ${recipeViewMode === 'list' ? 'flex flex-col justify-center' : ''}">
                        <h4 class="font-semibold ${isHorizontal ? 'text-sm' : 'text-base'} truncate">${recipe.name}</h4>
                        <p class="text-xs text-gray-500 mt-1 line-clamp-2">${recipe.description}</p>
                        <div class="flex items-center gap-3 mt-2 text-xs text-gray-500">
                            <span class="flex items-center gap-1">‚è±Ô∏è ${recipe.time}–º</span>
                            <span class="flex items-center gap-1">üî• ${recipe.calories}–∫–∫–∞–ª</span>
                        </div>
                        <div class="flex items-center justify-between mt-2">
                            <span class="text-xs px-2 py-1 rounded-full ${recipe.difficulty === 'easy' ? 'bg-green-100 text-green-700' : recipe.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'}">
                                ${recipe.difficulty === 'easy' ? '–õ–µ–≥–∫–æ' : recipe.difficulty === 'medium' ? '–°—Ä–µ–¥–Ω–µ' : '–°–ª–æ–∂–Ω–æ'}
                            </span>
                            <div class="flex items-center gap-1">
                                <span class="text-xs">‚≠ê ${recipe.rating}</span>
                                <span class="text-xs text-gray-400">(${recipe.reviews})</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function refreshRecommendations() {
            const shuffled = [...recipes].sort(() => Math.random() - 0.5);
            renderRecommendations();
            showToast('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
        }

        // ============================================
        // RECIPE MODAL
        // ============================================
        function openRecipe(id) {
            currentRecipe = recipes.find(r => r.id === id);
            const container = document.getElementById('recipeModalContent');
            
            container.innerHTML = `
                <div class="h-64 relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-emerald-50 to-teal-50"></div>
                    <img src="${getRecipePhoto(currentRecipe.id)}" alt="${currentRecipe.name}" class="w-full h-full object-cover relative z-0">
                    <button onclick="startCookingMode(${currentRecipe.id})" class="absolute bottom-4 right-4 p-4 bg-emerald-500 text-white rounded-2xl shadow-lg z-10">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </button>
                </div>
                <div class="p-4">
                    <div class="flex items-start justify-between">
                        <div>
                            <h2 class="text-2xl font-bold">${currentRecipe.name}</h2>
                            <p class="text-gray-500 mt-1">${currentRecipe.description}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="toggleFavorite()" class="p-3 bg-gray-100 rounded-xl">
                                <svg id="favoriteIcon" class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                </svg>
                            </button>
                            <button onclick="shareRecipe()" class="p-3 bg-gray-100 rounded-xl">
                                <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 mt-4">
                        <div class="flex-1 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-3 text-center">
                            <div class="text-2xl font-bold text-emerald-600">‚è±Ô∏è ${currentRecipe.time}–º</div>
                            <div class="text-xs text-gray-500">–í—Ä–µ–º—è</div>
                        </div>
                        <div class="flex-1 bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl p-3 text-center">
                            <div class="text-2xl font-bold text-orange-600">üî• ${currentRecipe.calories}</div>
                            <div class="text-xs text-gray-500">–∫–∫–∞–ª</div>
                        </div>
                        <div class="flex-1 bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3 text-center">
                            <div class="text-2xl font-bold text-purple-600">‚≠ê ${currentRecipe.rating}</div>
                            <div class="text-xs text-gray-500">${currentRecipe.reviews} –æ—Ç–∑.</div>
                        </div>
                    </div>

                    <!-- Nutrition -->
                    <div class="mt-4 p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl">
                        <h4 class="font-bold mb-3">üìä –ö–ë–ñ–£ –Ω–∞ –ø–æ—Ä—Ü–∏—é</h4>
                        <div class="grid grid-cols-4 gap-2 text-center">
                            <div class="p-2 bg-white rounded-xl">
                                <div class="text-red-500 font-bold">${currentRecipe.protein}–≥</div>
                                <div class="text-xs text-gray-500">–ë–µ–ª–∫–∏</div>
                            </div>
                            <div class="p-2 bg-white rounded-xl">
                                <div class="text-yellow-500 font-bold">${currentRecipe.fats}–≥</div>
                                <div class="text-xs text-gray-500">–ñ–∏—Ä—ã</div>
                            </div>
                            <div class="p-2 bg-white rounded-xl">
                                <div class="text-blue-500 font-bold">${currentRecipe.carbs}–≥</div>
                                <div class="text-xs text-gray-500">–£–≥–ª–µ–≤–æ–¥—ã</div>
                            </div>
                            <div class="p-2 bg-white rounded-xl">
                                <div class="text-emerald-500 font-bold">${Math.round((currentRecipe.protein * 4 + currentRecipe.fats * 9 + currentRecipe.carbs * 4) / 50)}–≥</div>
                                <div class="text-xs text-gray-500">–ö–ª–µ—Ç—á–∞—Ç–∫–∞</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex justify-between text-xs text-gray-500 mb-1">
                                <span>–î–Ω–µ–≤–Ω–∞—è –Ω–æ—Ä–º–∞</span>
                                <span>${Math.round(currentRecipe.calories / userProfile.targetCalories * 100)}%</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div class="h-full bg-emerald-500 rounded-full" style="width: ${Math.min(currentRecipe.calories / userProfile.targetCalories * 100, 100)}%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Tags -->
                    <div class="mt-4 flex flex-wrap gap-2">
                        ${currentRecipe.tags.map(tag => `<span class="px-3 py-1 bg-gray-100 rounded-full text-sm">#${tag}</span>`).join('')}
                    </div>

                    <!-- Ingredients -->
                    <div class="mt-4">
                        <h4 class="font-bold mb-3 flex items-center gap-2">
                            üõí –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
                            <span class="text-xs font-normal text-gray-500">(${currentRecipe.ingredients.length} —à—Ç)</span>
                        </h4>
                        <div class="space-y-2">
                            ${currentRecipe.ingredients.map((ing, i) => `
                                <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl cursor-pointer" onclick="this.classList.toggle('opacity-50')">
                                    <input type="checkbox" class="w-5 h-5 rounded-lg border-2 border-gray-300 text-emerald-500 focus:ring-emerald-500">
                                    <span class="text-sm flex-1">${ing}</span>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="addIngredientsToShoppingList(${currentRecipe.id})" class="w-full mt-3 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/30">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                            –î–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫
                        </button>
                    </div>

                    <!-- Steps -->
                    <div class="mt-4">
                        <h4 class="font-bold mb-3">üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h4>
                        <div class="space-y-3">
                            ${currentRecipe.steps.map((step, i) => `
                                <div class="flex gap-3">
                                    <div class="w-10 h-10 bg-gradient-to-br from-emerald-400 to-teal-500 text-white rounded-xl flex items-center justify-center font-bold flex-shrink-0 shadow-lg shadow-emerald-500/30">
                                        ${i + 1}
                                    </div>
                                    <div class="flex-1 pt-1">
                                        <p class="text-sm text-gray-700">${step}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Add to Plan Button -->
                    <button onclick="addToPlan(${currentRecipe.id})" class="w-full mt-4 py-4 bg-gradient-to-r from-orange-400 to-pink-500 text-white rounded-2xl font-bold text-lg shadow-lg shadow-orange-500/30 flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        –î–æ–±–∞–≤–∏—Ç—å –≤ –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è
                    </button>

                    <!-- Cooked Button -->
                    <button onclick="markAsCooked(${currentRecipe.id})" class="w-full mt-2 py-3 border-2 border-emerald-500 text-emerald-600 rounded-xl font-bold flex items-center justify-center gap-2">
                        <span>‚úÖ</span>
                        –Ø –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª(–∞)!
                    </button>
                </div>
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ—Ü–µ–ø—Ç–∞
            const favIcon = document.getElementById('favoriteIcon');
            if (favIcon) {
                favIcon.className = currentRecipe.isFavorite
                    ? 'w-6 h-6 text-red-500 fill-current'
                    : 'w-6 h-6 text-gray-400';
            }
            
            document.getElementById('recipeModal').classList.remove('hidden');
            hapticFeedback();
        }

        function closeRecipeModal() {
            document.getElementById('recipeModal').classList.add('hidden');
        }

        function toggleFavorite() {
            currentRecipe.isFavorite = !currentRecipe.isFavorite;
            document.getElementById('favoriteIcon').className = currentRecipe.isFavorite 
                ? 'w-6 h-6 text-red-500 fill-current' 
                : 'w-6 h-6 text-gray-400';
            
            if (currentRecipe.isFavorite) {
                userProfile.savedRecipes.push(currentRecipe.id);
                showToast('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ ‚ù§Ô∏è');
            } else {
                userProfile.savedRecipes = userProfile.savedRecipes.filter(id => id !== currentRecipe.id);
                showToast('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ');
            }
            saveToStorage();
            updateProfileStats();
        }

        function shareRecipe() {
            if (navigator.share) {
                navigator.share({
                    title: currentRecipe.name,
                    text: `–ü–æ—Å–º–æ—Ç—Ä–∏ —Ä–µ—Ü–µ–ø—Ç ${currentRecipe.name} –≤ –®–µ—Ñ-–ü–æ–º–æ—â–Ω–∏–∫–µ! ${currentRecipe.time} –º–∏–Ω, ${currentRecipe.calories} –∫–∫–∞–ª`,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(`–†–µ—Ü–µ–ø—Ç "${currentRecipe.name}": ${currentRecipe.time} –º–∏–Ω, ${currentRecipe.calories} –∫–∫–∞–ª\n\n${currentRecipe.ingredients.join('\n')}`);
                showToast('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            }
        }

        function markAsCooked(id) {
            const recipe = recipes.find(r => r.id === id);
            recipe.cooked = !recipe.cooked;
            if (recipe.cooked) {
                userProfile.cookedRecipes.push(id);
                userProfile.xp += 50;
                checkAchievements();
                showToast('–û—Ç–ª–∏—á–Ω–æ! +50 XP üéâ');
            } else {
                userProfile.cookedRecipes = userProfile.cookedRecipes.filter(i => i !== id);
            }
            saveToStorage();
            updateProfileStats();
            updateHomeStats();
        }

        // ============================================
        // COOKING MODE
        // ============================================
        function startCookingMode(id) {
            currentRecipe = recipes.find(r => r.id === id);
            currentCookingStep = 0;
            
            document.getElementById('cookingRecipeName').textContent = currentRecipe.name;
            document.getElementById('cookingMode').classList.remove('hidden');
            
            updateCookingStep();
            renderStepIndicators();
        }

        function exitCookingMode() {
            document.getElementById('cookingMode').classList.add('hidden');
            if (timerInterval) clearInterval(timerInterval);
        }

        function updateCookingStep() {
            document.getElementById('cookingStepNumber').textContent = `–®–∞–≥ ${currentCookingStep + 1}/${currentRecipe.steps.length}`;
            document.getElementById('cookingStepText').textContent = currentRecipe.steps[currentCookingStep];
            
            // Update indicators
            document.querySelectorAll('.step-indicator').forEach((ind, i) => {
                ind.classList.toggle('active', i === currentCookingStep);
                ind.classList.toggle('bg-emerald-500', i === currentCookingStep);
                ind.classList.toggle('text-white', i === currentCookingStep);
            });
        }

        function renderStepIndicators() {
            const container = document.getElementById('stepIndicators');
            container.innerHTML = currentRecipe.steps.map((_, i) => `
                <div class="step-indicator w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-bold flex-shrink-0" onclick="goToStep(${i})">${i + 1}</div>
            `).join('');
        }

        function goToStep(step) {
            currentCookingStep = step;
            updateCookingStep();
        }

        function prevCookingStep() {
            if (currentCookingStep > 0) {
                currentCookingStep--;
                updateCookingStep();
            }
        }

        function nextCookingStep() {
            if (currentCookingStep < currentRecipe.steps.length - 1) {
                currentCookingStep++;
                updateCookingStep();
            }
        }

        function toggleCookingStepComplete() {
            showToast('–®–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω!');
            nextCookingStep();
            if (currentCookingStep === currentRecipe.steps.length - 1) {
                markAsCooked(currentRecipe.id);
                showToast('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ë–ª—é–¥–æ –≥–æ—Ç–æ–≤–æ! üéâ');
                setTimeout(() => exitCookingMode(), 2000);
            }
        }

        function toggleCookingVoice() {
            showToast('–ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ü—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ "–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥" –∏–ª–∏ "–¢–∞–π–º–µ—Ä"');
        }

        // Timer
        let timerSeconds = 0;
        let timerRunning = false;

        function startTimer() {
            timerRunning = true;
            timerInterval = setInterval(() => {
                timerSeconds--;
                updateTimerDisplay();
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerRunning = false;
                    showToast('–¢–∞–π–º–µ—Ä –∑–∞–≤–µ—Ä—à—ë–Ω! üîî');
                    navigator.vibrate([200, 100, 200]);
                }
            }, 1000);
        }

        function pauseTimer() {
            timerRunning = false;
            clearInterval(timerInterval);
        }

        function resetTimer() {
            pauseTimer();
            timerSeconds = 0;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const mins = Math.floor(timerSeconds / 60);
            const secs = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            
            const progress = 283 - (283 * timerSeconds / (5 * 60)); // 5 min default
            document.getElementById('timerProgress').style.strokeDashoffset = Math.max(0, progress);
        }

        // ============================================
        // PLANNER
        // ============================================
        function renderWeekDays() {
            const days = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            const dayKeys = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            const container = document.getElementById('weekDays');
            
            container.innerHTML = days.map((day, i) => {
                const dayKey = dayKeys[i];
                const dayData = weeklyPlan[dayKey];
                const mealCount = Object.values(dayData).filter(m => m !== null).length;
                const hasMeals = mealCount > 0;
                const isToday = i === new Date().getDay() - 1;
                
                return `
                    <button onclick="selectDay('${dayKey}')" class="p-2 rounded-xl text-center transition-all ${hasMeals ? 'bg-emerald-100' : 'hover:bg-gray-100'} ${isToday ? 'ring-2 ring-emerald-500' : ''}">
                        <div class="text-xs ${isToday ? 'text-emerald-600 font-bold' : 'text-gray-500'}">${day}</div>
                        ${hasMeals ? `<div class="text-lg mt-1">üçΩÔ∏è</div>` : `<div class="w-2 h-2 bg-gray-300 rounded-full mx-auto mt-1"></div>`}
                        ${mealCount > 0 ? `<div class="text-xs text-emerald-600 font-bold mt-1">${mealCount}</div>` : ''}
                    </button>
                `;
            }).join('');
            
            updateWeekStats();
        }

        let selectedDay = 'monday';

        function selectDay(day) {
            selectedDay = day;
            document.getElementById('selectedDayTitle').textContent = getDayName(day);
            renderDayMeals();
            renderMealSuggestions();
            
            // Update tab styling
            ['breakfast', 'lunch', 'dinner'].forEach(type => {
                document.getElementById(`tab-${type}`).classList.remove('text-emerald-600', 'border-b-2', 'border-emerald-500');
                document.getElementById(`tab-${type}`).classList.add('text-gray-500');
            });
            document.getElementById(`tab-${selectedMealType}`).classList.add('text-emerald-600', 'border-b-2', 'border-emerald-500');
            document.getElementById(`tab-${selectedMealType}`).classList.remove('text-gray-500');
        }

        function selectMealType(type) {
            selectedMealType = type;
            ['breakfast', 'lunch', 'dinner'].forEach(t => {
                document.getElementById(`tab-${t}`).classList.remove('text-emerald-600', 'border-b-2', 'border-emerald-500');
                document.getElementById(`tab-${t}`).classList.add('text-gray-500');
            });
            document.getElementById(`tab-${type}`).classList.add('text-emerald-600', 'border-b-2', 'border-emerald-500');
            document.getElementById(`tab-${type}`).classList.remove('text-gray-500');
            renderDayMeals();
            renderMealSuggestions();
        }

        function renderDayMeals() {
            const container = document.getElementById('currentMealSlot');
            const recipe = weeklyPlan[selectedDay][selectedMealType];
            
            const mealTypeNames = { breakfast: 'üç≥ –ó–∞–≤—Ç—Ä–∞–∫', lunch: 'ü•ó –û–±–µ–¥', dinner: 'üçΩÔ∏è –£–∂–∏–Ω' };
            
            if (recipe) {
                container.innerHTML = `
                    <div class="flex items-center gap-3 p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl">
                        <div class="w-16 h-16 bg-white rounded-xl flex items-center justify-center text-3xl shadow-sm">
                            ${recipe.image}
                        </div>
                        <div class="flex-1">
                            <div class="text-xs text-gray-500">${mealTypeNames[selectedMealType]}</div>
                            <div class="font-bold">${recipe.name}</div>
                            <div class="text-sm text-gray-500">${recipe.time} –º–∏–Ω ‚Ä¢ ${recipe.calories} –∫–∫–∞–ª</div>
                        </div>
                        <button onclick="removeMeal('${selectedMealType}')" class="p-2 text-red-500 hover:bg-red-50 rounded-xl">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="p-6 bg-gray-50 rounded-2xl text-center">
                        <div class="text-4xl mb-2">${selectedMealType === 'breakfast' ? 'üç≥' : selectedMealType === 'lunch' ? 'ü•ó' : 'üçΩÔ∏è'}</div>
                        <p class="text-gray-500 mb-3">${mealTypeNames[selectedMealType]} –Ω–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</p>
                        <button onclick="showAddMealModal()" class="px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold">
                            + –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ
                        </button>
                    </div>
                `;
            }
        }

        function renderMealSuggestions() {
            const container = document.getElementById('suggestedMeals');
            const suggestions = recipes.filter(r => r.category === (selectedMealType === 'breakfast' ? 'breakfast' : selectedMealType === 'lunch' ? 'lunch' : 'dinner')).slice(0, 5);
            
            container.innerHTML = suggestions.map(recipe => `
                <div class="recipe-card flex-shrink-0 w-32 bg-white rounded-xl shadow-sm overflow-hidden" onclick="addRecipeToMeal(${recipe.id})">
                    <div class="h-20 bg-gradient-to-br from-emerald-50 to-teal-50 flex items-center justify-center text-3xl">
                        ${recipe.image}
                    </div>
                    <div class="p-2">
                        <h4 class="font-medium text-xs truncate">${recipe.name}</h4>
                        <p class="text-xs text-gray-500">${recipe.time}–º ‚Ä¢ ${recipe.calories}–∫–∫</p>
                    </div>
                </div>
            `).join('');
        }

        function addRecipeToMeal(id) {
            const recipe = recipes.find(r => r.id === id);
            weeklyPlan[selectedDay][selectedMealType] = recipe;
            saveToStorage();
            renderWeekDays();
            renderDayMeals();
            showToast('–ë–ª—é–¥–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–ª–∞–Ω!');
        }

        function removeMeal(type) {
            weeklyPlan[selectedDay][type] = null;
            saveToStorage();
            renderWeekDays();
            renderDayMeals();
        }

        function showAddMealModal() {
            const modal = document.getElementById('addRecipeModal');
            modal.classList.remove('hidden');
        }

        function closeAddRecipeModal() {
            document.getElementById('addRecipeModal').classList.add('hidden');
        }

        function addToPlan(id) {
            showAddMealModal();
            setTimeout(() => {
                selectMealType('dinner');
            }, 100);
        }

        function getDayName(day) {
            const names = { monday: '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', tuesday: '–í—Ç–æ—Ä–Ω–∏–∫', wednesday: '–°—Ä–µ–¥–∞', thursday: '–ß–µ—Ç–≤–µ—Ä–≥', friday: '–ü—è—Ç–Ω–∏—Ü–∞', saturday: '–°—É–±–±–æ—Ç–∞', sunday: '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ' };
            return names[day];
        }

        function changeWeek(direction) {
            showToast(direction > 0 ? '–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è' : '–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è');
        }

        function updateWeekStats() {
            let totalCalories = 0, totalProtein = 0, totalFats = 0, totalCarbs = 0, mealCount = 0;
            
            Object.values(weeklyPlan).forEach(day => {
                Object.values(day).forEach(meal => {
                    if (meal) {
                        totalCalories += meal.calories;
                        totalProtein += meal.protein;
                        totalFats += meal.fats;
                        totalCarbs += meal.carbs;
                        mealCount++;
                    }
                });
            });
            
            const avg = mealCount > 0 ? Math.round(totalCalories / mealCount) : 0;
            document.getElementById('weekCalories').textContent = avg;
            document.getElementById('weekProtein').textContent = Math.round(totalProtein / (mealCount || 1)) + '–≥';
            document.getElementById('weekFats').textContent = Math.round(totalFats / (mealCount || 1)) + '–≥';
            document.getElementById('weekCarbs').textContent = Math.round(totalCarbs / (mealCount || 1)) + '–≥';
        }

        function copyLastWeekPlan() {
            showToast('–ü–ª–∞–Ω —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
            renderWeekDays();
        }

        function clearWeekPlan() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é?')) {
                Object.keys(weeklyPlan).forEach(day => {
                    weeklyPlan[day] = { breakfast: null, lunch: null, dinner: null };
                });
                saveToStorage();
                renderWeekDays();
                showToast('–ü–ª–∞–Ω –æ—á–∏—â–µ–Ω');
            }
        }

        // ============================================
        // SHOPPING LIST
        // ============================================
        function renderShoppingList() {
            const container = document.getElementById('shoppingList');
            updateShoppingStats();
            
            container.innerHTML = shoppingList.map(item => `
                <div class="flex items-center gap-3 p-4 bg-white rounded-2xl shadow-sm ${item.bought ? 'opacity-50' : ''}" onclick="toggleBought(${item.id})">
                    <div class="w-8 h-8 rounded-full border-2 ${item.bought ? 'bg-emerald-500 border-emerald-500' : 'border-gray-300'} flex items-center justify-center">
                        ${item.bought ? '<svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg>' : ''}
                    </div>
                    <div class="flex-1">
                        <div class="font-bold ${item.bought ? 'line-through text-gray-400' : ''}">${item.name}</div>
                        <div class="text-sm text-gray-500">${item.amount}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-emerald-600">~${item.estimatedPrice}‚ÇΩ</div>
                        <span class="text-xs px-2 py-1 bg-gray-100 rounded-full">${getCategoryEmoji(item.category)}</span>
                    </div>
                    <button onclick="event.stopPropagation(); deleteShoppingItem(${item.id})" class="p-2 text-red-500">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        function updateShoppingStats() {
            document.getElementById('shoppingTotal').textContent = shoppingList.length;
            document.getElementById('shoppingBought').textContent = shoppingList.filter(i => i.bought).length;
            document.getElementById('shoppingLeft').textContent = shoppingList.filter(i => !i.bought).length;
            const total = shoppingList.filter(i => !i.bought).reduce((sum, i) => sum + (i.estimatedPrice || 0), 0);
            document.getElementById('shoppingEst').textContent = total.toLocaleString() + '‚ÇΩ';
        }

        function getCategoryEmoji(category) {
            const emojis = { vegetables: 'ü•¨', meat: 'ü•©', dairy: 'üßÄ', grains: 'üåæ', spices: 'üßÇ', other: 'üì¶' };
            return emojis[category] || 'üì¶';
        }

        function toggleBought(id) {
            const item = shoppingList.find(i => i.id === id);
            item.bought = !item.bought;
            saveToStorage();
            renderShoppingList();
        }

        function deleteShoppingItem(id) {
            shoppingList = shoppingList.filter(i => i.id !== id);
            saveToStorage();
            renderShoppingList();
            showToast('–£–¥–∞–ª–µ–Ω–æ');
        }

        function filterShopping(category) {
            renderShoppingList();
            showToast(category === 'all' ? '–ü–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ' : `–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}`);
        }

        function showQuickAdd() {
            const modal = document.getElementById('addRecipeModal');
            modal.classList.remove('hidden');
        }

        function generateFromPlan() {
            const ingredients = new Set();
            Object.values(weeklyPlan).forEach(day => {
                Object.values(day).forEach(meal => {
                    if (meal) {
                        meal.ingredients.forEach(ing => ingredients.add(ing));
                    }
                });
            });
            
            ingredients.forEach(ing => {
                if (!shoppingList.some(s => s.name.toLowerCase() === ing.toLowerCase())) {
                    shoppingList.push({
                        id: Date.now() + Math.random(),
                        name: ing,
                        amount: '–ø–æ –≤–∫—É—Å—É',
                        category: 'other',
                        bought: false,
                        estimatedPrice: Math.floor(Math.random() * 200) + 50
                    });
                }
            });
            saveToStorage();
            renderShoppingList();
            showToast(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${ingredients.size} –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤`);
        }

        function addIngredientsToShoppingList(recipeId) {
            const recipe = recipes.find(r => r.id === recipeId);
            recipe.ingredients.forEach(ing => {
                if (!shoppingList.some(s => s.name.toLowerCase() === ing.toLowerCase())) {
                    shoppingList.push({
                        id: Date.now() + Math.random(),
                        name: ing,
                        amount: '–ø–æ –≤–∫—É—Å—É',
                        category: 'other',
                        bought: false,
                        estimatedPrice: Math.floor(Math.random() * 300) + 100
                    });
                }
            });
            saveToStorage();
            renderShoppingList();
            showToast('–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ø–∏—Å–æ–∫');
        }

        function orderFromStore() {
            const items = shoppingList.filter(i => !i.bought);
            if (items.length === 0) {
                showToast('–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –ø—É—Å—Ç');
                return;
            }
            showToast('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞...');
            // Would integrate with delivery APIs
        }

        // ============================================
        // COMMUNITY
        // ============================================
        function renderCommunityFeed() {
            const container = document.getElementById('communityFeed');
            container.innerHTML = communityPosts.map(post => `
                <div class="community-post bg-white rounded-2xl shadow-sm overflow-hidden">
                    <div class="p-4 flex items-center gap-3">
                        <div class="w-12 h-12 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-xl flex items-center justify-center text-2xl">
                            ${post.avatar}
                        </div>
                        <div class="flex-1">
                            <div class="font-bold">${post.user}</div>
                            <div class="text-xs text-gray-500">${post.time}</div>
                        </div>
                        <button class="p-2">
                            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"/>
                            </svg>
                        </button>
                    </div>
                    <p class="px-4 pb-2">${post.content}</p>
                    ${post.image ? `<div class="h-48 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center text-6xl">${post.image}</div>` : ''}
                    ${post.recipes.length > 0 ? `
                        <div class="p-3 flex gap-2 overflow-x-auto">
                            ${post.recipes.map(rId => {
                                const r = recipes.find(x => x.id === rId);
                                return r ? `<div class="flex-shrink-0 bg-emerald-50 px-3 py-2 rounded-xl flex items-center gap-2">
                                    <span>${r.image}</span>
                                    <span class="text-sm font-medium">${r.name}</span>
                                </div>` : '';
                            }).join('')}
                        </div>
                    ` : ''}
                    <div class="p-4 border-t border-gray-100 flex items-center gap-4">
                        <button onclick="toggleLike(${post.id})" class="flex items-center gap-1 ${post.isLiked ? 'text-red-500' : 'text-gray-500'}">
                            <span class="text-xl ${post.isLiked ? 'like-animated' : ''}">${post.isLiked ? '‚ù§Ô∏è' : 'ü§ç'}</span>
                            <span>${post.likes}</span>
                        </button>
                        <button class="flex items-center gap-1 text-gray-500">
                            <span class="text-xl">üí¨</span>
                            <span>${post.comments}</span>
                        </button>
                        <button class="flex items-center gap-1 text-gray-500">
                            <span class="text-xl">üîÑ</span>
                            <span>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function filterFeed(type) {
            showToast(`–§–∏–ª—å—Ç—Ä: ${type}`);
            renderCommunityFeed();
        }

        function toggleLike(id) {
            const post = communityPosts.find(p => p.id === id);
            post.isLiked = !post.isLiked;
            post.likes += post.isLiked ? 1 : -1;
            renderCommunityFeed();
        }

        function showCreatePost() {
            document.getElementById('createPostModal').classList.remove('hidden');
        }

        function closeCreatePostModal() {
            document.getElementById('createPostModal').classList.add('hidden');
        }

        function publishPost() {
            const content = document.getElementById('postContent').value;
            if (!content.trim()) {
                showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏');
                return;
            }
            
            communityPosts.unshift({
                id: Date.now(),
                user: userProfile.name,
                avatar: 'üë®‚Äçüç≥',
                time: '–¢–æ–ª—å–∫–æ —á—Ç–æ',
                content: content,
                image: null,
                likes: 0,
                comments: 0,
                isLiked: false,
                recipes: []
            });
            
            saveToStorage();
            renderCommunityFeed();
            closeCreatePostModal();
            document.getElementById('postContent').value = '';
            showToast('–ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞! üéâ');
        }

        function attachRecipeToPost() {
            showToast('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç –∏–∑ —Å–ø–∏—Å–∫–∞');
            // Would open recipe picker
        }

        // ============================================
        // CHATBOT
        // ============================================
        function addInitialChatMessage() {
            const container = document.getElementById('chatMessages');
            container.innerHTML = `
                <div class="flex gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-full flex items-center justify-center flex-shrink-0 text-xl">ü§ñ</div>
                    <div class="bg-gradient-to-r from-gray-100 to-gray-50 rounded-2xl rounded-tl-none p-4 max-w-[85%]">
                        <p class="text-sm">–ü—Ä–∏–≤–µ—Ç! –Ø –®–µ—Ñ-–ë–æ—Ç üç≥ –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?</p>
                        <div class="flex flex-wrap gap-2 mt-3">
                            <button onclick="sendQuickMessage('–°–æ–∑–¥–∞–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é')" class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs">üìÖ –ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é</button>
                            <button onclick="sendQuickMessage('–ß—Ç–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –∏–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞?')" class="px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-xs">‚ùì –ò–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</button>
                            <button onclick="sendQuickMessage('–ü–ü —Ä–µ—Ü–µ–ø—Ç—ã')" class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs">üí™ –ü–ü —Ä–µ—Ü–µ–ø—Ç—ã</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;
            
            addChatMessage(message, 'user');
            input.value = '';
            input.style.height = 'auto';
            
            // Simulate AI typing
            setTimeout(() => {
                const response = generateAIResponse(message);
                addChatMessage(response, 'bot');
            }, 1000);
        }

        function sendQuickMessage(message) {
            document.getElementById('chatInput').value = message;
            sendMessage();
        }

        function addChatMessage(text, type) {
            const container = document.getElementById('chatMessages');
            const isUser = type === 'user';
            
            container.innerHTML += `
                <div class="flex gap-3 ${isUser ? 'flex-row-reverse' : ''}">
                    <div class="w-10 h-10 ${isUser ? 'bg-gray-200' : 'bg-gradient-to-br from-emerald-400 to-teal-500'} rounded-full flex items-center justify-center flex-shrink-0 text-xl">
                        ${isUser ? 'üë§' : 'ü§ñ'}
                    </div>
                    <div class="bg-gradient-to-r ${isUser ? 'from-emerald-500 to-teal-500 text-white' : 'from-gray-100 to-gray-50'} rounded-2xl ${isUser ? 'rounded-tr-none' : 'rounded-tl-none'} p-4 max-w-[85%]">
                        <p class="text-sm whitespace-pre-line">${text}</p>
                    </div>
                </div>
            `;
            
            container.scrollTop = container.scrollHeight;
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('–ø–ª–∞–Ω') || lowerMessage.includes('–Ω–µ–¥–µ–ª—é')) {
                return '–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! üìÖ –í–æ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é:\n\n**–ü–Ω:** –û–≤—Å—è–Ω–∫–∞ —Å —è–≥–æ–¥–∞–º–∏ (350–∫–∫) / –°–∞–ª–∞—Ç —Å –∫—É—Ä–∏—Ü–µ–π (400–∫–∫) / –†—ã–±–∞ —Å –æ–≤–æ—â–∞–º–∏ (450–∫–∫)\n\n**–í—Ç:** –Ø–∏—á–Ω–∏—Ü–∞ —Å –∞–≤–æ–∫–∞–¥–æ (320–∫–∫) / –ë–æ—Ä—â (350–∫–∫) / –ü–∞—Å—Ç–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞ (450–∫–∫)\n\n**–°—Ä:** –°–º—É–∑–∏ –±–æ—É–ª (290–∫–∫) / –°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å (280–∫–∫) / –û–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É (220–∫–∫)\n\n**–ß—Ç:** –¢–≤–æ—Ä–æ–≥ —Å –º–µ–¥–æ–º (250–∫–∫) / –†–∏—Å —Å –∫—É—Ä–∏—Ü–µ–π (480–∫–∫) / –õ–æ—Å–æ—Å—å –Ω–∞ –≥—Ä–∏–ª–µ (380–∫–∫)\n\n**–ü—Ç:** –ö–∞—à–∞ (300–∫–∫) / –°–∞–ª–∞—Ç —Å —Ç—É–Ω—Ü–æ–º (350–∫–∫) / –î–æ–º–∞—à–Ω—è—è –ø–∏—Ü—Ü–∞ (500–∫–∫)\n\n**–°–±:** –ë–ª–∏–Ω—ã (380–∫–∫) / –ü–µ–ª—å–º–µ–Ω–∏ (450–∫–∫) / –®–æ–∫–æ–ª–∞–¥–Ω—ã–π –º—É—Å—Å (380–∫–∫)\n\n**–í—Å:** –Ø–π—Ü–∞ –ø–∞—à–æ—Ç (280–∫–∫) / –ü–ª–æ–≤ (520–∫–∫) / –°–µ–º–µ–π–Ω—ã–π —É–∂–∏–Ω\n\n–•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ—Ç –ø–ª–∞–Ω –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å?';
            }
            
            if (lowerMessage.includes('—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫') || lowerMessage.includes('–∏–º–µ—é—â–∏—Ö—Å—è') || lowerMessage.includes('–ø—Ä–æ–¥—É–∫—Ç')) {
                return '–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å! üßä\n\n**–ò–∑ –≤–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–∫—É–ø–æ–∫):**\n\nü•¨ –û–≤–æ—â–∏ ‚Üí –û–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É, –°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å\nü•© –ú—è—Å–æ ‚Üí –ö—É—Ä–∏–Ω—ã–π —Å—É–ø, –®–∞—à–ª—ã–∫, –°—Ç–µ–π–∫\nüßÄ –ú–æ–ª–æ—á–Ω–æ–µ ‚Üí –°—ã—Ä–Ω–∏–∫–∏, –ú–∞–∫–∞—Ä–æ–Ω—ã —Å —Å—ã—Ä–æ–º\n\n**–°–∞–º—ã–µ –±—ã—Å—Ç—Ä—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã (–¥–æ 15 –º–∏–Ω):**\n1. ü•ë –ê–≤–æ–∫–∞–¥–æ-—Ç–æ—Å—Ç ‚Äî 10 –º–∏–Ω\n2. üç≥ –Ø–∏—á–Ω–∏—Ü–∞ ‚Äî 5 –º–∏–Ω\n3. ü•ó –ë—ã—Å—Ç—Ä—ã–π —Å–∞–ª–∞—Ç ‚Äî 7 –º–∏–Ω\n4. ü•™ –°—ç–Ω–¥–≤–∏—á ‚Äî 10 –º–∏–Ω\n\n–ö–∞–∫–æ–π —Ä–µ—Ü–µ–ø—Ç –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç? –ú–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é!';
            }
            
            if (lowerMessage.includes('–ø–ø') || lowerMessage.includes('–ø–æ—Ö—É–¥–µ–Ω–∏–µ') || lowerMessage.includes('–∑–¥–æ—Ä–æ–≤') || lowerMessage.includes('–¥–∏–µ—Ç')) {
                return '–î–ª—è –∑–¥–æ—Ä–æ–≤–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é: üí™\n\n**–ù–∏–∑–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω—ã–µ –±–ª—é–¥–∞ (–¥–æ 300–∫–∫):**\n‚Ä¢ ü•ó –°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å ‚Äî 280–∫–∫\n‚Ä¢ ü´ê –°–º—É–∑–∏ –±–æ—É–ª ‚Äî 290–∫–∫\n‚Ä¢ ü•ï –û–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É ‚Äî 220–∫–∫\n‚Ä¢ üêü –õ–æ—Å–æ—Å—å –Ω–∞ –≥—Ä–∏–ª–µ ‚Äî 380–∫–∫ (–ø–æ–ª–µ–∑–Ω—ã–µ –∂–∏—Ä—ã!)\n\n**–í—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤—ã–µ:**\n‚Ä¢ üçó –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ ‚Äî 165–∫–∫ / 31–≥ –±–µ–ª–∫–∞\n‚Ä¢ üêü –†—ã–±–∞ ‚Äî 200–∫–∫ / 25–≥ –±–µ–ª–∫–∞\n‚Ä¢ ü•ö –Ø–π—Ü–∞ ‚Äî 70–∫–∫ / 6–≥ –±–µ–ª–∫–∞\n\n**–°–æ–≤–µ—Ç:** –°–æ—á–µ—Ç–∞–π—Ç–µ –±–µ–ª–∫–∏ —Å –æ–≤–æ—â–∞–º–∏ –¥–ª—è —Å—ã—Ç–Ω–æ—Å—Ç–∏!';
            }
            
            if (lowerMessage.includes('–±—ã—Å—Ç—Ä—ã–π') || lowerMessage.includes('—É–∂–∏–Ω') || lowerMessage.includes('–æ–±–µ–¥') || lowerMessage.includes('–∑–∞–≤—Ç—Ä–∞–∫')) {
                let type = lowerMessage.includes('–∑–∞–≤—Ç—Ä–∞–∫') ? '–∑–∞–≤—Ç—Ä–∞–∫' : lowerMessage.includes('–æ–±–µ–¥') ? '–æ–±–µ–¥' : '—É–∂–∏–Ω';
                const time = lowerMessage.includes('15') || lowerMessage.includes('–±—ã—Å—Ç—Ä') ? 15 : lowerMessage.includes('30') ? 30 : 45;
                
                const filtered = recipes.filter(r => r.time <= time && (r.category === type || r.time <= time));
                
                return `‚ö° –ë—ã—Å—Ç—Ä—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã –Ω–∞ ${type} (–¥–æ ${time} –º–∏–Ω):\n\n${filtered.slice(0, 5).map((r, i) => `${i + 1}. ${r.image} **${r.name}** ‚Äî ${r.time} –º–∏–Ω, ${r.calories} –∫–∫`).join('\n')}\n\n–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏!`;
            }
            
            if (lowerMessage.includes('–≤–µ–≥–∞–Ω') || lowerMessage.includes('–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω–µ—Ü')) {
                return 'üå± –í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–µ –∏ –≤–µ–≥–∞–Ω—Å–∫–∏–µ —Ä–µ—Ü–µ–ø—Ç—ã:\n\n**–í–µ–≥–∞–Ω:**\n‚Ä¢ ü´ê –°–º—É–∑–∏ –±–æ—É–ª\n‚Ä¢ ü•ï –û–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É\n‚Ä¢ üßÜ –§–∞–ª–∞—Ñ–µ–ª—å\n\n**–í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–µ:**\n‚Ä¢ ü•ó –°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å\n‚Ä¢ üçù –ü–∞—Å—Ç–∞ (–º–æ–∂–Ω–æ –±–µ–∑ –º—è—Å–∞)\n‚Ä¢ üç∞ –¢–æ—Ä—Ç—ã –∏ –¥–µ—Å–µ—Ä—Ç—ã\n\n**–°–æ–≤–µ—Ç:** –î–æ–±–∞–≤—å—Ç–µ —Ç–æ—Ñ—É, tempeh –∏–ª–∏ –±–æ–±–æ–≤—ã–µ –¥–ª—è –±–µ–ª–∫–∞!';
            }
            
            if (lowerMessage.includes('–¥–µ—Å–µ—Ä—Ç') || lowerMessage.includes('—Å–ª–∞–¥–∫–æ–µ') || lowerMessage.includes('–≤—ã–ø–µ—á–∫–∞')) {
                return 'üç∞ –í–∫—É—Å–Ω—ã–µ –¥–µ—Å–µ—Ä—Ç—ã:\n\n**–ë—ã—Å—Ç—Ä—ã–µ (–¥–æ 30 –º–∏–Ω):**\n‚Ä¢ üç´ –®–æ–∫–æ–ª–∞–¥–Ω—ã–π –º—É—Å—Å ‚Äî 380–∫–∫\n‚Ä¢ ü•û –ü–∞–Ω–∫–µ–π–∫–∏ ‚Äî 380–∫–∫\n‚Ä¢ üç∞ –¢–∏—Ä–∞–º–∏—Å—É ‚Äî 450–∫–∫\n\n**–ù–∏–∑–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω—ã–µ:**\n‚Ä¢ üçì –§—Ä—É–∫—Ç–æ–≤—ã–π —Å–∞–ª–∞—Ç ‚Äî 150–∫–∫\n‚Ä¢ ü´ê –Ø–≥–æ–¥—ã —Å–æ —Å–ª–∏–≤–∫–∞–º–∏ ‚Äî 200–∫–∫\n‚Ä¢ üçå –ë–∞–Ω–∞–Ω–æ–≤—ã–µ –æ–ª–∞–¥—å–∏ ‚Äî 250–∫–∫\n\n–•–æ—Ç–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å –¥–µ—Å–µ—Ä—Ç–∞?';
            }
            
            if (lowerMessage.includes('–∫–∞–ª–æ—Ä–∏–π') || lowerMessage.includes('–∫–±–∂—É')) {
                return 'üìä –†–∞—Å—á—ë—Ç –ö–ë–ñ–£:\n\n–î–ª—è –ø–æ—Ö—É–¥–µ–Ω–∏—è: 1500-1800 –∫–∫/–¥–µ–Ω—å\n–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è: 2000-2200 –∫–∫/–¥–µ–Ω—å\n–î–ª—è –Ω–∞–±–æ—Ä–∞ –º–∞—Å—Å—ã: 2500-3000 –∫–∫/–¥–µ–Ω—å\n\n**–°—Ä–µ–¥–Ω–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ:**\n‚Ä¢ –ë–µ–ª–∫–∏: 20-30% (1.5-2–≥ –Ω–∞ –∫–≥ –≤–µ—Å–∞)\n‚Ä¢ –ñ–∏—Ä—ã: 25-35% (0.8-1–≥ –Ω–∞ –∫–≥ –≤–µ—Å–∞)\n‚Ä¢ –£–≥–ª–µ–≤–æ–¥—ã: 40-50% (–æ—Å—Ç–∞—Ç–æ–∫)\n\n–°–µ–≥–æ–¥–Ω—è –≤—ã —Å—ä–µ–ª–∏: **${userProfile.dailyNutrition.calories}** –∫–∫–∞–ª –∏–∑ **${userProfile.targetCalories}**';
            }
            
            if (lowerMessage.includes('–ø—Ä–∏–≤–µ—Ç') || lowerMessage.includes('–∑–¥—Ä–∞–≤')) {
                return '–ü—Ä–∏–≤–µ—Ç! üëã –Ø –®–µ—Ñ-–ë–æ—Ç ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç!\n\n**–ß—Ç–æ —è —É–º–µ—é:**\n‚Ä¢ üìÖ –°–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é\n‚Ä¢ üîç –ò—Å–∫–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç—ã –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º\n‚Ä¢ üí™ –ü–æ–¥–±–∏—Ä–∞—Ç—å –ü–ü-–±–ª—é–¥–∞\n‚Ä¢ üìä –°—á–∏—Ç–∞—Ç—å –∫–∞–ª–æ—Ä–∏–∏ –∏ –ö–ë–ñ–£\n‚Ä¢ üç≥ –î–∞–≤–∞—Ç—å –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ —Å–æ–≤–µ—Ç—ã\n\n–ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å —Å–µ–≥–æ–¥–Ω—è?';
            }
            
            return `–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! üç≥\n\n–Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å:\n‚Ä¢ üìù –ü–æ–¥–±–æ—Ä–æ–º —Ä–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º\n‚Ä¢ üìÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º–µ–Ω—é –Ω–∞ –Ω–µ–¥–µ–ª—é\n‚Ä¢ üìä –†–∞—Å—á—ë—Ç–æ–º –ö–ë–ñ–£\n‚Ä¢ üí™ –ü–æ–¥–±–æ—Ä–æ–º –¥–∏–µ—Ç–∏—á–µ—Å–∫–∏—Ö –±–ª—é–¥\n‚Ä¢ üë®‚Äçüç≥ –û—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å:\n¬´–ß—Ç–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–∞ —É–∂–∏–Ω?¬ª\n¬´–†–µ—Ü–µ–ø—Ç—ã –¥–ª—è –ø–æ—Ö—É–¥–µ–Ω–∏—è¬ª\n¬´–ü–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é¬ª`;
        }

        function toggleVoiceInput() {
            showToast('–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω...');
        }

        // ============================================
        // PROFILE
        // ============================================
        function updateProfileStats() {
            document.getElementById('userName').textContent = userProfile.name;
            document.getElementById('userGoal').textContent = getGoalLabel(userProfile.goal);
            document.getElementById('userRecipes').textContent = userProfile.myRecipes.length;
            document.getElementById('userSaved').textContent = userProfile.savedRecipes.length;
            document.getElementById('userCooked').textContent = userProfile.cookedRecipes.length;
            document.getElementById('userFollowing').textContent = userProfile.following.length;
            document.getElementById('userStreak').textContent = userProfile.streak;
            document.getElementById('userLevel').textContent = userProfile.level;
            document.getElementById('streakCount').textContent = userProfile.streak;
            
            if (userProfile.streak > 0) {
                document.getElementById('streakBadge').classList.remove('hidden');
            }
            
            // XP Bar
            const xpForNextLevel = userProfile.level * 500;
            const xpProgress = (userProfile.xp / xpForNextLevel) * 100;
            document.getElementById('xpProgress').textContent = `${userProfile.xp}/${xpForNextLevel} XP`;
            document.getElementById('xpBar').style.width = `${xpProgress}%`;
            
            // Weight
            const currentWeight = userProfile.weightHistory[userProfile.weightHistory.length - 1];
            document.getElementById('currentWeight').textContent = currentWeight || '--';
            
            if (userProfile.weightHistory.length >= 2) {
                const diff = currentWeight - userProfile.weightHistory[0];
                document.getElementById('weightChange').textContent = `–ó–∞ –Ω–µ–¥–µ–ª—é: ${diff > 0 ? '+' : ''}${diff.toFixed(1)} –∫–≥`;
            }
            
            // Render weight chart
            renderWeightChart();
            
            // Render my recipes
            renderMyRecipes();

            // –û–±–Ω–æ–≤–ª—è–µ–º UI –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
            renderDislikedIngredients();
            renderFridgeProducts();
            renderPreferredKitchensUI();
            document.getElementById('fridgeSearchToggle').textContent = searchPreferences.useFridge ? '–í–∫–ª' : '–í—ã–∫–ª';
            document.getElementById('fridgeSearchToggle').className = 'px-2 py-1 text-xs rounded-full ' + (searchPreferences.useFridge ? 'bg-emerald-50 text-emerald-700' : 'bg-gray-100 text-gray-500');
        }

        function renderWeightChart() {
            const container = document.getElementById('weightChart');
            const weights = userProfile.weightHistory.slice(-7);
            const max = Math.max(...weights);
            const min = Math.min(...weights);
            const range = max - min || 1;
            
            container.innerHTML = weights.map(w => {
                const height = ((w - min) / range * 40) + 20;
                return `<div class="flex-1 bg-gradient-to-t from-emerald-400 to-teal-500 rounded-t" style="height: ${height}%"></div>`;
            }).join('');
        }

        function renderMyRecipes() {
            const container = document.getElementById('myRecipesList');
            const saved = recipes.filter(r => userProfile.myRecipes.includes(r.id) || r.isFavorite).slice(0, 5);
            
            container.innerHTML = saved.map(r => `
                <div class="recipe-card flex-shrink-0 w-28 h-28 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-2 flex flex-col items-center justify-center" onclick="openRecipe(${r.id})">
                    <span class="text-3xl">${r.image}</span>
                    <span class="text-xs font-medium mt-1 text-center truncate w-full">${r.name}</span>
                </div>
            `).join('') + `
                <div class="flex-shrink-0 w-28 h-28 bg-gray-100 rounded-xl flex flex-col items-center justify-center border-2 border-dashed border-gray-300" onclick="openAddRecipeModal()">
                    <span class="text-3xl mb-1">+</span>
                    <span class="text-xs text-gray-500">–î–æ–±–∞–≤–∏—Ç—å</span>
                </div>
            `;
        }

        function getGoalLabel(goal) {
            const labels = { lose: 'üìâ –ü–æ—Ö—É–¥–µ–Ω–∏–µ', maintain: '‚öñÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ', gain: 'üìà –ù–∞–±–æ—Ä –º–∞—Å—Å—ã' };
            return labels[goal];
        }

        function toggleDiet(diet) {
            const isActive = userProfile.diets.includes(diet);
            const indicator = document.getElementById(`diet-${diet}`);
            
            if (isActive) {
                userProfile.diets = userProfile.diets.filter(d => d !== diet);
                indicator.classList.remove('bg-emerald-500', 'border-emerald-500');
                indicator.classList.add('border-gray-300');
                indicator.innerHTML = '';
            } else {
                userProfile.diets.push(diet);
                indicator.classList.remove('border-gray-300');
                indicator.classList.add('bg-emerald-500', 'border-emerald-500');
                indicator.innerHTML = '<svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg>';
            }
            saveToStorage();
            renderRecommendations();
        }

        function togglePreferredKitchen(kitchen) {
            const idx = userProfile.preferredKitchens.indexOf(kitchen);
            if (idx >= 0) {
                userProfile.preferredKitchens.splice(idx, 1);
            } else {
                userProfile.preferredKitchens.push(kitchen);
            }
            saveToStorage();
            renderPreferredKitchensUI();
            renderRecommendations();
        }

        function renderPreferredKitchensUI() {
            const container = document.getElementById('preferredKitchensContainer');
            if (!container) return;
            Array.from(container.children).forEach(btn => {
                const text = btn.textContent.toLowerCase();
                let key = null;
                if (text.includes('–∏—Ç–∞–ª—å—è–Ω')) key = 'italian';
                else if (text.includes('–∞–∑–∏–∞—Ç')) key = 'asian';
                else if (text.includes('—Å—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä')) key = 'mediterranean';
                else if (text.includes('—Ä—É—Å')) key = 'russian';
                else if (text.includes('–º–µ–∫—Å–∏–∫–∞–Ω')) key = 'mexican';
                if (!key) return;
                if (userProfile.preferredKitchens.includes(key)) {
                    btn.classList.remove('bg-gray-100');
                    btn.classList.add('bg-emerald-500', 'text-white');
                } else {
                    btn.classList.add('bg-gray-100');
                    btn.classList.remove('bg-emerald-500', 'text-white');
                }
            });
        }

        function addDislikedIngredient() {
            const input = document.getElementById('dislikedInput');
            const value = input.value.trim();
            if (!value) return;
            if (!userProfile.dislikedIngredients.includes(value)) {
                userProfile.dislikedIngredients.push(value);
                saveToStorage();
                renderDislikedIngredients();
                renderRecommendations();
            }
            input.value = '';
        }

        function renderDislikedIngredients() {
            const container = document.getElementById('dislikedList');
            if (!container) return;
            container.innerHTML = userProfile.dislikedIngredients.map((item, index) => `
                <span class="px-3 py-1 bg-red-50 text-red-700 rounded-full flex items-center gap-1">
                    ${item}
                    <button onclick="removeDislikedIngredient(${index})" class="text-xs">‚úï</button>
                </span>
            `).join('');
        }

        function removeDislikedIngredient(index) {
            userProfile.dislikedIngredients.splice(index, 1);
            saveToStorage();
            renderDislikedIngredients();
            renderRecommendations();
        }

        function addFridgeProduct() {
            const input = document.getElementById('fridgeInput');
            const value = input.value.trim();
            if (!value) return;
            if (!userProfile.fridgeProducts.includes(value)) {
                userProfile.fridgeProducts.push(value);
                saveToStorage();
                renderFridgeProducts();
                renderRecommendations();
            }
            input.value = '';
        }

        function renderFridgeProducts() {
            const container = document.getElementById('fridgeList');
            if (!container) return;
            container.innerHTML = userProfile.fridgeProducts.map((item, index) => `
                <span class="px-3 py-1 bg-blue-50 text-blue-700 rounded-full flex items-center gap-1">
                    ${item}
                    <button onclick="removeFridgeProduct(${index})" class="text-xs">‚úï</button>
                </span>
            `).join('');
        }

        function removeFridgeProduct(index) {
            userProfile.fridgeProducts.splice(index, 1);
            saveToStorage();
            renderFridgeProducts();
            renderRecommendations();
        }

        function toggleFridgeSearch() {
            searchPreferences.useFridge = !searchPreferences.useFridge;
            saveToStorage();
            updateProfileStats();
            showToast(searchPreferences.useFridge ? '–ü–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –∏–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞ –≤–∫–ª—é—á—ë–Ω' : '–ü–æ–∏—Å–∫ –ø–æ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫—É –≤—ã–∫–ª—é—á–µ–Ω');
            renderRecommendations();
        }

        function toggleAllergy(allergy) {
            const isActive = userProfile.allergies.includes(allergy);
            const button = event.currentTarget;
            
            if (isActive) {
                userProfile.allergies = userProfile.allergies.filter(a => a !== allergy);
                button.classList.remove('bg-red-100', 'text-red-700', 'border-red-300');
                button.classList.add('bg-gray-100');
            } else {
                userProfile.allergies.push(allergy);
                button.classList.remove('bg-gray-100');
                button.classList.add('bg-red-100', 'text-red-700', 'border-red-300');
            }
            saveToStorage();
        }

        function setGoal(goal) {
            userProfile.goal = goal;
            
            document.querySelectorAll('.goal-btn').forEach(btn => {
                btn.classList.remove('border-emerald-500', 'bg-emerald-50');
                btn.classList.add('border-gray-200');
            });
            
            const activeBtn = document.querySelector(`[data-goal="${goal}"]`);
            activeBtn.classList.remove('border-gray-200');
            activeBtn.classList.add('border-emerald-500', 'bg-emerald-50');
            
            if (goal === 'lose') userProfile.targetCalories = 1800;
            else if (goal === 'gain') userProfile.targetCalories = 2500;
            else userProfile.targetCalories = 2000;
            
            saveToStorage();
            updateNutritionProgress();
            showToast(`–¶–µ–ª—å: ${getGoalLabel(goal)}`);
        }

        function updateNutritionProgress() {
            const progress = (userProfile.dailyNutrition.calories / userProfile.targetCalories) * 100;
            const circle = document.getElementById('caloriesProgress');
            const offset = 283 - (283 * Math.min(progress, 100) / 100);
            circle.style.strokeDashoffset = offset;
            
            document.getElementById('caloriesCurrent').textContent = userProfile.dailyNutrition.calories;
            document.getElementById('caloriesTarget').textContent = userProfile.targetCalories;
            document.getElementById('proteinCurrent').textContent = userProfile.dailyNutrition.protein + '–≥';
            document.getElementById('fatsCurrent').textContent = userProfile.dailyNutrition.fats + '–≥';
            document.getElementById('carbsCurrent').textContent = userProfile.dailyNutrition.carbs + '–≥';
            document.getElementById('fiberCurrent').textContent = userProfile.dailyNutrition.fiber + '–≥';
        }

        function addWater(glasses) {
            userProfile.waterGlasses += glasses;
            if (userProfile.waterGlasses > userProfile.targetWater) userProfile.waterGlasses = userProfile.targetWater;
            saveToStorage();
            updateWaterProgress();
            updateHomeStats();
            
            if (userProfile.waterGlasses >= userProfile.targetWater) {
                showToast('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –î–Ω–µ–≤–Ω–∞—è –Ω–æ—Ä–º–∞ –≤–æ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∞! üíßüéâ');
            }
        }

        function resetWater() {
            userProfile.waterGlasses = 0;
            saveToStorage();
            updateWaterProgress();
            updateHomeStats();
        }

        function updateWaterProgress() {
            const progress = (userProfile.waterGlasses / userProfile.targetWater) * 100;
            document.getElementById('waterProgress').textContent = `${userProfile.waterGlasses}/${userProfile.targetWater} —Å—Ç–∞–∫–∞–Ω–æ–≤`;
        }

        function showQuickAddWater() {
            addWater(1);
            showToast('+1 —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã üíß');
        }

        function addWeight() {
            const weight = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–µ—Å (–∫–≥):');
            if (weight && !isNaN(weight)) {
                userProfile.weightHistory.push(parseFloat(weight));
                saveToStorage();
                updateProfileStats();
                showToast('–í–µ—Å –æ–±–Ω–æ–≤–ª—ë–Ω!');
            }
        }

        function showSettings() {
            showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–∫—Ä–æ—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
        }

        function showHelp() {
            showToast('–°–ø—Ä–∞–≤–∫–∞ –∏ FAQ');
        }

        function showAchievements() {
            document.getElementById('achievementsModal').classList.remove('hidden');
        }

        function closeAchievementsModal() {
            document.getElementById('achievementsModal').classList.add('hidden');
        }

        function checkAchievements() {
            // Check streak
            if (userProfile.cookedRecipes.length >= 7 && !userProfile.achievements.includes('streak7')) {
                userProfile.achievements.push('streak7');
                userProfile.streak = Math.max(userProfile.streak, 7);
                showToast('üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: 7 –¥–Ω–µ–π –≥–æ—Ç–æ–≤–∫–∏!');
            }
            
            // Level up
            const newLevel = Math.floor(userProfile.xp / 500) + 1;
            if (newLevel > userProfile.level) {
                userProfile.level = newLevel;
                showToast(`üéâ –£—Ä–æ–≤–µ–Ω—å ${newLevel}! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!`);
            }
            
            // Update badges
            if (userProfile.achievements.length > 0) {
                document.getElementById('achievementDot').classList.remove('hidden');
            }
        }

        function exportData() {
            const data = JSON.stringify(userProfile, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'chef-helper-data.json';
            a.click();
            showToast('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã');
        }

        // ============================================
        // RECIPE CREATION
        // ============================================
        function openAddRecipeModal() {
            document.getElementById('addRecipeModal').classList.remove('hidden');
        }

        function toggleRecipeTag(tag) {
            const button = event.currentTarget;
            if (recipeTags.includes(tag)) {
                recipeTags = recipeTags.filter(t => t !== tag);
                button.classList.remove('bg-emerald-500', 'text-white', 'border-emerald-500');
                button.classList.add('border-gray-200');
            } else {
                recipeTags.push(tag);
                button.classList.add('bg-emerald-500', 'text-white', 'border-emerald-500');
                button.classList.remove('border-gray-200');
            }
        }

        function saveRecipe(event) {
            event.preventDefault();
            
            const newRecipe = {
                id: Date.now(),
                name: document.getElementById('newRecipeName').value,
                description: document.getElementById('newRecipeDesc').value,
                image: 'üç≥',
                time: parseInt(document.getElementById('newRecipeTime').value) || 30,
                calories: parseInt(document.getElementById('newRecipeCalories').value) || 300,
                difficulty: document.getElementById('newRecipeDifficulty').value,
                category: recipeTags[0] || 'dinner',
                kitchen: 'custom',
                protein: 15,
                fats: 10,
                carbs: 30,
                rating: 0,
                reviews: 0,
                cookCount: 0,
                tags: recipeTags,
                ingredients: document.getElementById('newRecipeIngredients').value.split('\n').filter(i => i.trim()),
                steps: document.getElementById('newRecipeSteps').value.split('\n').filter(s => s.trim() && !s.match(/^\d+\./)),
                isFavorite: true,
                cooked: false
            };
            
            recipes.unshift(newRecipe);
            userProfile.myRecipes.push(newRecipe.id);
            userProfile.xp += 100;
            
            saveToStorage();
            renderAllRecipes();
            updateProfileStats();
            closeAddRecipeModal();
            
            // Reset form
            document.getElementById('addRecipeForm').reset();
            recipeTags = [];
            document.querySelectorAll('.recipe-tag').forEach(tag => {
                tag.classList.remove('bg-emerald-500', 'text-white', 'border-emerald-500');
                tag.classList.add('border-gray-200');
            });
            
            showToast('–†–µ—Ü–µ–ø—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω! +100 XP üéâ');
        }

        // ============================================
        // VOICE MODE
        // ============================================
        function toggleVoiceMode() {
            voiceMode = !voiceMode;
            
            if (voiceMode) {
                document.getElementById('voiceOverlay').classList.remove('hidden');
                document.getElementById('voiceIndicator').classList.remove('hidden');
                startVoiceRecognition();
            } else {
                stopVoiceMode();
            }
        }

        function stopVoiceMode() {
            voiceMode = false;
            document.getElementById('voiceOverlay').classList.add('hidden');
            document.getElementById('voiceIndicator').classList.add('hidden');
            if (recognition) {
                recognition.stop();
                recognition = null;
            }
        }

        let recognition = null;

        function startVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.lang = 'ru-RU';
                recognition.continuous = true;
                recognition.interimResults = true;
                
                recognition.onresult = (event) => {
                    const last = event.results.length - 1;
                    const command = event.results[last][0].transcript.trim();
                    document.getElementById('voiceStatus').textContent = `¬´${command}¬ª`;
                    document.getElementById('voiceStatus2').textContent = `¬´${command}¬ª`;
                    document.getElementById('voiceResult').textContent = '–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ';
                    document.getElementById('voiceResult2').textContent = '–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ';
                };
                
                recognition.onend = () => {
                    if (voiceMode) {
                        recognition.start();
                    }
                };
                
                recognition.onerror = () => {
                    document.getElementById('voiceStatus').textContent = '–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è';
                };
                
                recognition.start();
            } else {
                showToast('–ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                voiceMode = false;
                stopVoiceMode();
            }
        }

        // ============================================
        // HOME STATS
        // ============================================
        function updateHomeStats() {
            document.getElementById('homeCalories').textContent = userProfile.dailyNutrition.calories;
            document.getElementById('homeWater').textContent = `${userProfile.waterGlasses}/${userProfile.targetWater}`;
            document.getElementById('homeRecipes').textContent = userProfile.cookedRecipes.length;
        }

        // ============================================
        // PWA INSTALL
        // ============================================
        let deferredPrompt;

        function checkInstallPrompt() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                setTimeout(() => {
                    if (deferredPrompt) {
                        document.getElementById('installPrompt').classList.remove('hidden');
                    }
                }, 30000);
            });
        }

        function dismissInstallPrompt() {
            document.getElementById('installPrompt').classList.add('hidden');
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showToast('–°–ø–∞—Å–∏–±–æ –∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É! üéâ');
                    }
                    deferredPrompt = null;
                    document.getElementById('installPrompt').classList.add('hidden');
                });
            }
        }

        // ============================================
        // TOAST
        // ============================================
        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.remove('hidden');
            hapticFeedback();
            
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        function hapticFeedback() {
            if (navigator.vibrate) {
                navigator.vibrate(10);
            }
        }

        // ============================================
        // UTILITIES
        // ============================================
        function loadMoreRecipes() {
            showToast('–ó–∞–≥—Ä—É–∑–∫–∞...');
            // Would load more from server
        }

        // Initialize planner
        renderDayMeals();
    </script>
</body>
</html>
